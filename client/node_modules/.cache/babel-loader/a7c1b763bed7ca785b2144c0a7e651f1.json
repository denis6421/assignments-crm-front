{"ast":null,"code":"import _regeneratorRuntime from\"/Users/denis/Desktop/projects/todo/front/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _toConsumableArray from\"/Users/denis/Desktop/projects/todo/front/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _asyncToGenerator from\"/Users/denis/Desktop/projects/todo/front/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/Users/denis/Desktop/projects/todo/front/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/denis/Desktop/projects/todo/front/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/Users/denis/Desktop/projects/todo/front/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/Users/denis/Desktop/projects/todo/front/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/Users/denis/Desktop/projects/todo/front/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import React,{Component}from\"react\";import{permissions_options}from\"./permissions_options\";import SwitchComponent from\"../../../../parts/SwitchComponent\";import{connect}from\"react-redux\";import*as actions from\"../../../../actions/actions\";import{withRouter}from\"react-router\";import{apiPostRequest}from\"../../../../tools/api\";import{SETTINGS_ROUTE,EMPLOYEE_DASHBOARD_SETTINGS}from\"../../../../tools/routes\";import{Link}from'react-router-dom';import NavigateBeforeIcon from'@material-ui/icons/NavigateBefore';var PermissionsSettings=/*#__PURE__*/function(_Component){_inherits(PermissionsSettings,_Component);function PermissionsSettings(){var _this;_classCallCheck(this,PermissionsSettings);_this=_possibleConstructorReturn(this,_getPrototypeOf(PermissionsSettings).call(this));_this.update=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(permission){var _this$props$user,permissions,user,old_permissions,updated_permissions,body,api,res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_this$props$user=_this.props.user,permissions=_this$props$user.permissions,user=_this$props$user.user;old_permissions=_toConsumableArray(permissions);updated_permissions=_toConsumableArray(permissions);if(updated_permissions.includes(permission)){updated_permissions=updated_permissions.filter(function(m){return m!==permission;});}else{updated_permissions=[].concat(_toConsumableArray(updated_permissions),[permission]);}body={user:user._id,permissions:updated_permissions};api=\"account-settings/update\";_this.props.updateUserReducer('permissions',updated_permissions);_context.next=9;return apiPostRequest(api,body);case 9:res=_context.sent;if(!res.ok){_this.props.updateUserReducer('permissions',old_permissions);}case 11:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();_this.state={user_permissions:[]};return _this;}_createClass(PermissionsSettings,[{key:\"render\",value:function render(){var _this2=this;var _this$props$user2=this.props.user,permissions=_this$props$user2.permissions,user=_this$props$user2.user;var system_text=this.props.global.system_text;return React.createElement(\"div\",{className:\"settings__permissions\"},React.createElement(\"header\",{className:\"sticky__top\"},React.createElement(Link,{className:\"back__button flex__start\",to:user.is_manager?SETTINGS_ROUTE:EMPLOYEE_DASHBOARD_SETTINGS},React.createElement(NavigateBeforeIcon,null),system_text.SETTINGS)),React.createElement(\"h2\",null,system_text.EMPLOYEE_PERMISSIONS),React.createElement(\"ul\",{className:\"settings__permissions__list\"},permissions_options.map(function(m,i){return React.createElement(\"li\",null,React.createElement(SwitchComponent,{key:i,active_text:system_text[m.text],inactive_text:system_text[m.text],updateEmployee:_this2.update,value:permissions.includes(m.code),property_name:m.code}));})));}}]);return PermissionsSettings;}(Component);function mapStateToProps(_ref2){var user=_ref2.user,global=_ref2.global;return{user:user,global:global};}export default withRouter(connect(mapStateToProps,actions)(PermissionsSettings));","map":{"version":3,"sources":["/Users/denis/Desktop/projects/todo/front/client/src/components/settings/categories/permissions/PermissionsSettings.jsx"],"names":["React","Component","permissions_options","SwitchComponent","connect","actions","withRouter","apiPostRequest","SETTINGS_ROUTE","EMPLOYEE_DASHBOARD_SETTINGS","Link","NavigateBeforeIcon","PermissionsSettings","update","permission","props","user","permissions","old_permissions","updated_permissions","includes","filter","m","body","_id","api","updateUserReducer","res","ok","state","user_permissions","system_text","global","is_manager","SETTINGS","EMPLOYEE_PERMISSIONS","map","i","text","code","mapStateToProps"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport { permissions_options } from \"./permissions_options\";\nimport SwitchComponent from \"../../../../parts/SwitchComponent\";\nimport { connect } from \"react-redux\";\nimport * as actions from \"../../../../actions/actions\";\nimport { withRouter } from \"react-router\";\nimport { apiPostRequest } from \"../../../../tools/api\";\nimport { SETTINGS_ROUTE, EMPLOYEE_DASHBOARD_SETTINGS } from \"../../../../tools/routes\";\nimport {Link} from 'react-router-dom'\nimport NavigateBeforeIcon from '@material-ui/icons/NavigateBefore';\nclass PermissionsSettings extends Component {\n  constructor() {\n    super();\n    this.state = {\n      user_permissions: [],\n    };\n  }\n  update = async (permission) => {\n    const { permissions, user } = this.props.user;\n    let old_permissions = [...permissions]\n    let updated_permissions = [...permissions]\n    if (updated_permissions.includes(permission)) {\n        updated_permissions = updated_permissions.filter((m) => m !== permission);\n    } else {\n        updated_permissions = [...updated_permissions, permission];\n    }\n    const body = {\n        user:user._id,\n        permissions:updated_permissions\n    }\n    const api = \"account-settings/update\";\n    this.props.updateUserReducer('permissions', updated_permissions)\n    const res = await apiPostRequest(api, body);\n    if(!res.ok){\n      this.props.updateUserReducer('permissions', old_permissions)\n    }\n  \n  };\n\n  render() {\n    const { permissions, user } = this.props.user;\n    const {system_text} =this.props.global\n    return (\n      <div className=\"settings__permissions\">\n        <header className='sticky__top'>\n        <Link\n        className='back__button flex__start'\n        to ={user.is_manager ? SETTINGS_ROUTE  :EMPLOYEE_DASHBOARD_SETTINGS}>\n          <NavigateBeforeIcon />{system_text.SETTINGS}\n        </Link>\n        </header>\n    <h2>{system_text.EMPLOYEE_PERMISSIONS}</h2>\n        <ul className=\"settings__permissions__list\">\n          {permissions_options.map((m, i) => {\n            return (\n              <li>\n                <SwitchComponent\n                  key={i}\n                  active_text={system_text[m.text]}\n                  inactive_text={system_text[m.text]}\n                  updateEmployee={this.update}\n                  value={\n                    permissions.includes(m.code)\n                  }\n                  property_name={m.code}\n                />\n              </li>\n            );\n          })}\n        </ul>\n      </div>\n    );\n  }\n}\n\nfunction mapStateToProps({ user, global }) {\n  return { user, global };\n}\n\nexport default withRouter(\n  connect(mapStateToProps, actions)(PermissionsSettings)\n);\n"]},"metadata":{},"sourceType":"module"}