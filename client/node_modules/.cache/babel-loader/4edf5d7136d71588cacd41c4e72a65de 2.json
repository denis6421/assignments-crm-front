{"ast":null,"code":"import _regeneratorRuntime from\"/Users/denis/Desktop/projects/todo/front/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _defineProperty from\"/Users/denis/Desktop/projects/todo/front/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _asyncToGenerator from\"/Users/denis/Desktop/projects/todo/front/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/Users/denis/Desktop/projects/todo/front/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/denis/Desktop/projects/todo/front/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/Users/denis/Desktop/projects/todo/front/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/Users/denis/Desktop/projects/todo/front/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/Users/denis/Desktop/projects/todo/front/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;});keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach(function(key){_defineProperty(target,key,source[key]);});}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source));}else{ownKeys(source).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}}return target;}import React,{Component}from\"react\";import{Editor}from\"react-draft-wysiwyg\";import\"react-draft-wysiwyg/dist/react-draft-wysiwyg.css\";import{convertFromRaw,convertToRaw,EditorState}from\"draft-js\";import CloseOutlinedIcon from\"@material-ui/icons/CloseOutlined\";import SubmitButtons from\"../../../parts/SubmitButtons\";var saveContent=function saveContent(content){return JSON.stringify(convertToRaw(content.getCurrentContent()));};var AssignmentComments=/*#__PURE__*/function(_Component){_inherits(AssignmentComments,_Component);function AssignmentComments(){var _this;_classCallCheck(this,AssignmentComments);_this=_possibleConstructorReturn(this,_getPrototypeOf(AssignmentComments).call(this));_this.onEditorStateChange=function(val){_this.setState({comments:val});};_this.close=function(){_this.setState({loaded:false});setTimeout(function(){_this.props.updateParentState(\"assignment_comments\");},300);};_this.save=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(comments){var assignment,updated,rawDraftContentState;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:assignment=_this.props.assignment;updated=_objectSpread({},assignment);_this.setState({loading:true});_context.next=5;return saveContent(comments);case 5:rawDraftContentState=_context.sent;updated[\"comments\"]=rawDraftContentState;_context.next=9;return _this.props.updateAssignment(updated);case 9:_this.close();case 10:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();_this.state={};return _this;}_createClass(AssignmentComments,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;var assignment=this.props.assignment;setTimeout(function(){_this2.setState({loaded:true});},20);this.setState({loaded:true});var comments=\"\";if(assignment.comments){var content=convertFromRaw(JSON.parse(assignment.comments));comments=EditorState.createWithContent(content);}this.setState({comments:comments});}},{key:\"render\",value:function render(){var _this3=this;var _this$state=this.state,comments=_this$state.comments,loaded=_this$state.loaded,loading=_this$state.loading;var _this$props=this.props,assignment=_this$props.assignment,system_text=_this$props.system_text;return React.createElement(\"div\",{id:loaded?\"employee__assignment__comments--active\":\"\",className:\"employee__assignment__comments\"},React.createElement(\"section\",{className:\"overlay\"}),React.createElement(\"form\",{className:\"flex__column\"},React.createElement(\"button\",{type:\"button\",onClick:function onClick(){return _this3.close();},className:\"employee__assignment__comments__close\"},React.createElement(CloseOutlinedIcon,null)),React.createElement(\"header\",null,React.createElement(\"h2\",null,system_text.ASSIGNMENT),React.createElement(\"h3\",null,\"\".concat(assignment.title))),React.createElement(\"div\",{className:\"employee__assignment__comments__editor\"},React.createElement(Editor,{editorState:comments,toolbarClassName:\"toolbarClassName\",wrapperClassName:\"wrapperClassName\",editorClassName:\"editorClassName\",onEditorStateChange:this.onEditorStateChange,placeholder:system_text.COMMENT})),React.createElement(SubmitButtons,{submit:function submit(){return comments?_this3.save(comments):'';},loading:loading,close_text:system_text.CANCEL,close:this.close,submit_text:system_text.SAVE,button_type:true})));}}]);return AssignmentComments;}(Component);export default AssignmentComments;","map":{"version":3,"sources":["/Users/denis/Desktop/projects/todo/front/client/src/components/employee-page/parts/AssignmentComments.jsx"],"names":["React","Component","Editor","convertFromRaw","convertToRaw","EditorState","CloseOutlinedIcon","SubmitButtons","saveContent","content","JSON","stringify","getCurrentContent","AssignmentComments","onEditorStateChange","val","setState","comments","close","loaded","setTimeout","props","updateParentState","save","assignment","updated","loading","rawDraftContentState","updateAssignment","state","parse","createWithContent","system_text","ASSIGNMENT","title","COMMENT","CANCEL","SAVE"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport { Editor } from \"react-draft-wysiwyg\";\nimport \"react-draft-wysiwyg/dist/react-draft-wysiwyg.css\";\nimport { convertFromRaw, convertToRaw, EditorState } from \"draft-js\";\nimport CloseOutlinedIcon from \"@material-ui/icons/CloseOutlined\";\nimport SubmitButtons from \"../../../parts/SubmitButtons\";\nconst saveContent = (content) => {\n  return JSON.stringify(convertToRaw(content.getCurrentContent()));\n};\n\nclass AssignmentComments extends Component {\n  constructor() {\n    super();\n    this.state = {};\n  }\n\n  componentDidMount() {\n    const { assignment } = this.props;\n    setTimeout(() => {\n      this.setState({\n        loaded: true,\n      });\n    }, 20);\n    this.setState({\n      loaded: true,\n    });\n    let comments = \"\";\n    if (assignment.comments) {\n      let content = convertFromRaw(JSON.parse(assignment.comments));\n\n      comments = EditorState.createWithContent(content);\n    }\n    this.setState({\n      comments,\n    });\n  }\n\n  onEditorStateChange = (val) => {\n    this.setState({\n      comments: val,\n    });\n  };\n\n  close = () => {\n    this.setState({\n      loaded: false,\n    });\n    setTimeout(() => {\n      this.props.updateParentState(\"assignment_comments\");\n    }, 300);\n  };\n\n  save = async (comments) => {\n    const { assignment } = this.props;\n    const updated = { ...assignment };\n    this.setState({\n      loading:true\n    })\n    const rawDraftContentState = await saveContent(comments);\n    updated[\"comments\"] = rawDraftContentState;\n    await this.props.updateAssignment(updated);\n    this.close();\n  };\n\n  render() {\n    const { comments, loaded, loading } = this.state;\n    const { assignment, system_text } = this.props;\n    return (\n      <div\n        id={loaded ? \"employee__assignment__comments--active\" : \"\"}\n        className=\"employee__assignment__comments\"\n      >\n        <section className=\"overlay\"></section>\n        <form className=\"flex__column\">\n          <button\n          type ='button'\n          onClick = {() => this.close()}\n          className='employee__assignment__comments__close'\n          ><CloseOutlinedIcon /></button>\n          <header>\n            <h2>{system_text.ASSIGNMENT}</h2>\n            <h3>{`${assignment.title}`}</h3>\n          </header>\n          <div className=\"employee__assignment__comments__editor\">\n            <Editor\n              editorState={comments}\n              toolbarClassName=\"toolbarClassName\"\n              wrapperClassName=\"wrapperClassName\"\n              editorClassName=\"editorClassName\"\n              onEditorStateChange={this.onEditorStateChange}\n              placeholder={system_text.COMMENT}\n            />\n          </div>\n          <SubmitButtons\n          submit = {() => comments ? this.save(comments) : '' }\n          loading ={loading}\n          close_text =  {system_text.CANCEL}\n          close = {this.close}\n          submit_text = {system_text.SAVE}\n          button_type = {true}\n          />\n        </form>\n      </div>\n    );\n  }\n}\n\nexport default AssignmentComments;\n"]},"metadata":{},"sourceType":"module"}