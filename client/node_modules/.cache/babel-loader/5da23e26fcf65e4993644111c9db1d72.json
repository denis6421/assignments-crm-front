{"ast":null,"code":"import _regeneratorRuntime from\"/Users/denis/Desktop/projects/todo/front/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/denis/Desktop/projects/todo/front/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _defineProperty from\"/Users/denis/Desktop/projects/todo/front/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _classCallCheck from\"/Users/denis/Desktop/projects/todo/front/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/denis/Desktop/projects/todo/front/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/Users/denis/Desktop/projects/todo/front/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/Users/denis/Desktop/projects/todo/front/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/Users/denis/Desktop/projects/todo/front/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;});keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach(function(key){_defineProperty(target,key,source[key]);});}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source));}else{ownKeys(source).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}}return target;}import React,{Component}from\"react\";import TextInput from\"../../../parts/inputs/TextInput\";import signup_inputs from\"./signup-inputs\";import{apiPostRequest}from\"../../../tools/api\";import{withRouter}from\"react-router\";import{connect}from\"react-redux\";import*as actions from\"../../../actions/actions\";import{setCookie}from\"../../../tools/cookie\";import{AUTH_TOKEN}from\"../../../tools/keys\";import SumbitBtn from\"../../../parts/SumbitBtn\";import SignupSuccess from\"./SignupSuccess\";import{EMPLOYEES_ROUTE}from\"../../../tools/routes\";var signUpForm=/*#__PURE__*/function(_Component){_inherits(signUpForm,_Component);function signUpForm(){var _this;_classCallCheck(this,signUpForm);_this=_possibleConstructorReturn(this,_getPrototypeOf(signUpForm).call(this));_this.updateForm=function(name,value){var form_data=_objectSpread({},_this.state.form_data);form_data[name]=value;_this.setState({form_data:form_data});};_this.submitForm=function(e){e.preventDefault();_this.setState({validate:true});setTimeout(function(){var errors=document.querySelectorAll(\".text__input__error\");if(errors.length===0){_this.signup();}_this.setState({validate:false});},50);};_this.signup=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var form_data,api,res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:form_data=_this.state.form_data;api=\"users/create\";_this.setState({loading:true});_context.next=5;return apiPostRequest(api,form_data);case 5:res=_context.sent;if(res.ok){_this.props.updateUserReducer(\"user\",res.result);setCookie(AUTH_TOKEN,res.result.token);_this.setState({signup_success:true});setTimeout(function(){_this.props.history.push(EMPLOYEES_ROUTE);},3000);}if(!res.ok&&res.result){_this.props.updateGlobalReducer('error',res.result);}_this.setState({loading:false});case 9:case\"end\":return _context.stop();}}},_callee);}));_this.state={form_data:{}};return _this;}_createClass(signUpForm,[{key:\"render\",value:function render(){var _this2=this;var _this$state=this.state,form_data=_this$state.form_data,validate=_this$state.validate,error_popup=_this$state.error_popup,loading=_this$state.loading,signup_success=_this$state.signup_success;return React.createElement(\"div\",{className:\"login flex__center\"},React.createElement(SignupSuccess,{active:signup_success}),React.createElement(\"form\",{style:{filter:signup_success?'blur(2px)':''},onSubmit:function onSubmit(e){return _this2.submitForm(e);},className:\"login__form signup__form flex__column\"},React.createElement(\"h2\",null,\"Signup\"),error_popup?React.createElement(\"p\",null,error_popup):\"\",React.createElement(\"section\",{className:\"login__form__inputs\"},signup_inputs.map(function(input,i){return React.createElement(TextInput,{key:i,handleUpdate:_this2.updateForm,input:input,validate:validate,value:form_data[input.property_name]});})),React.createElement(SumbitBtn,{text:\"Submit\",active:loading})));}}]);return signUpForm;}(Component);function mapStateToProps(_ref2){var user=_ref2.user;return{user:user};}export default withRouter(connect(mapStateToProps,actions)(signUpForm));","map":{"version":3,"sources":["/Users/denis/Desktop/projects/todo/front/client/src/components/login/parts/SignUpForm.jsx"],"names":["React","Component","TextInput","signup_inputs","apiPostRequest","withRouter","connect","actions","setCookie","AUTH_TOKEN","SumbitBtn","SignupSuccess","EMPLOYEES_ROUTE","signUpForm","updateForm","name","value","form_data","state","setState","submitForm","e","preventDefault","validate","setTimeout","errors","document","querySelectorAll","length","signup","api","loading","res","ok","props","updateUserReducer","result","token","signup_success","history","push","updateGlobalReducer","error_popup","filter","map","input","i","property_name","mapStateToProps","user"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport TextInput from \"../../../parts/inputs/TextInput\";\nimport signup_inputs from \"./signup-inputs\";\nimport { apiPostRequest } from \"../../../tools/api\";\nimport { withRouter } from \"react-router\";\nimport { connect } from \"react-redux\";\nimport * as actions from \"../../../actions/actions\";\nimport { setCookie } from \"../../../tools/cookie\";\nimport { AUTH_TOKEN } from \"../../../tools/keys\";\nimport SumbitBtn from \"../../../parts/SumbitBtn\";\nimport SignupSuccess from \"./SignupSuccess\";\nimport { EMPLOYEES_ROUTE } from \"../../../tools/routes\";\n\nclass signUpForm extends Component {\n  constructor() {\n    super();\n    this.state = {\n      form_data: {},\n    };\n  }\n\n  updateForm = (name, value) => {\n    const form_data = { ...this.state.form_data };\n    form_data[name] = value;\n    this.setState({\n      form_data,\n    });\n  };\n  submitForm = (e) => {\n    e.preventDefault();\n    this.setState({\n      validate: true,\n    });\n    setTimeout(() => {\n      const errors = document.querySelectorAll(\".text__input__error\");\n      if (errors.length === 0) {\n        this.signup();\n      }\n      this.setState({\n        validate: false,\n      });\n    }, 50);\n  };\n\n  signup = async () => {\n    const { form_data } = this.state;\n    const api = \"users/create\";\n    this.setState({\n      loading: true,\n    });\n    const res = await apiPostRequest(api, form_data);\n    if (res.ok) {\n      this.props.updateUserReducer(\"user\", res.result);\n      setCookie(AUTH_TOKEN, res.result.token);\n      this.setState({\n        signup_success:true\n      })\n      setTimeout(() => {\n        this.props.history.push(EMPLOYEES_ROUTE)\n      }, 3000);\n    }\n    if (!res.ok && res.result) {\n      this.props.updateGlobalReducer('error',res.result);\n    }\n    this.setState({\n      loading: false,\n    });\n  };\n  render() {\n    const { form_data, validate, error_popup, loading, signup_success } = this.state;\n    return (\n      <div className=\"login flex__center\">\n        <SignupSuccess \n        active = {signup_success}\n        />\n        <form\n        style ={{\n          filter:signup_success ? 'blur(2px)' : '',\n        \n        }}\n          onSubmit={(e) => this.submitForm(e)}\n          className=\"login__form signup__form flex__column\"\n        >\n          <h2>Signup</h2>\n          {error_popup ? <p>{error_popup}</p> : \"\"}\n          <section className=\"login__form__inputs\">\n            {signup_inputs.map((input, i) => {\n              return (\n                <TextInput\n                  key={i}\n                  handleUpdate={this.updateForm}\n                  input={input}\n                  validate={validate}\n                  value={form_data[input.property_name]}\n                />\n              );\n            })}\n          </section>\n          <SumbitBtn text=\"Submit\" active={loading} />\n        </form>\n      </div>\n    );\n  }\n}\n\nfunction mapStateToProps({ user }) {\n  return { user };\n}\n\nexport default withRouter(connect(mapStateToProps, actions)(signUpForm));\n"]},"metadata":{},"sourceType":"module"}