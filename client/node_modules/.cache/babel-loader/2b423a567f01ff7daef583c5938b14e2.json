{"ast":null,"code":"import _defineProperty from\"/Users/denis/Desktop/projects/todo/front/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _regeneratorRuntime from\"/Users/denis/Desktop/projects/todo/front/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/denis/Desktop/projects/todo/front/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/Users/denis/Desktop/projects/todo/front/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/denis/Desktop/projects/todo/front/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/Users/denis/Desktop/projects/todo/front/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/Users/denis/Desktop/projects/todo/front/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/Users/denis/Desktop/projects/todo/front/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import React,{Component}from\"react\";import{withRouter}from\"react-router\";import{connect}from\"react-redux\";import*as actions from\"../../actions/actions\";import EmployeeMenu from\"./parts/EmployeeMenu\";import EmploeeAssignments from\"./employee-assignments/EmploeeAssignments\";import{apiGetRequest,apiPostRequest}from\"../../tools/api\";import EmployeeProfile from\"./employee-assignments/EmployeeProfile\";import HandleProfile from\"../employees/parts/HandleProfile\";var EmployeePage=/*#__PURE__*/function(_Component){_inherits(EmployeePage,_Component);function EmployeePage(){var _this;_classCallCheck(this,EmployeePage);_this=_possibleConstructorReturn(this,_getPrototypeOf(EmployeePage).call(this));_this.changeSection=function(profile){_this.setState({profile:profile});};_this.getEmployee=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(id){var api,res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:api=\"employee/get-by-id?id=\".concat(id);_context.next=3;return apiGetRequest(api);case 3:res=_context.sent;if(res.ok){setTimeout(function(){_this.setState({employee:res.result,page_loaded:true});},100);}case 5:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();_this.updateEmployee=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(employee,pw_chaned){var api,res;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(pw_chaned)_this.resetEmployeePassword(employee);api=\"employee/update\";_context2.next=4;return apiPostRequest(api,employee);case 4:res=_context2.sent;if(res.ok){_this.setState({employee:res.result});}case 6:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x2,_x3){return _ref2.apply(this,arguments);};}();_this.updateState=function(name,value){_this.setState(_defineProperty({},name,value));};_this.toggleHandleEmployee=function(active){_this.setState({handle_employee:active});};_this.resetEmployeePassword=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(profile){var api,body;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:api=\"employee/password-reset\";body={_id:profile._id,password:profile.password};_context3.next=4;return apiPostRequest(api,body);case 4:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x4){return _ref3.apply(this,arguments);};}();_this.state={active_section:\"assignments\",assignments:[]};return _this;}_createClass(EmployeePage,[{key:\"componentDidMount\",value:function(){var _componentDidMount=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){var id;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:id=this.props.match.params.id;_context4.next=3;return this.getEmployee(id);case 3:case\"end\":return _context4.stop();}}},_callee4,this);}));function componentDidMount(){return _componentDidMount.apply(this,arguments);}return componentDidMount;}()},{key:\"render\",value:function render(){var _this$state=this.state,employee=_this$state.employee,active_section=_this$state.active_section,page_loaded=_this$state.page_loaded,handle_employee=_this$state.handle_employee,profile=_this$state.profile;var user=this.props.user.user;var system_text=this.props.global.system_text;return page_loaded&&employee?React.createElement(\"div\",{className:\"employee__page\",id:!user.is_manager?\"employee__page--employee\":\"\"},handle_employee?React.createElement(HandleProfile,{toggleHandleProfile:this.toggleHandleEmployee,profile_to_edit:employee,returnEmployee:this.updateEmployee,save:this.updateEmployee,resetPassword:this.resetEmployeePassword,edit_text:system_text.EDIT_EMPLOYEE}):\"\",user.is_manager?React.createElement(EmployeeMenu,{system_text:system_text,changeSection:this.changeSection,active_section:active_section,active:true,employee:employee?employee:{},user:user}):\"\",React.createElement(EmploeeAssignments,{hide_page:profile,employee:employee,updateEmployee:this.updateEmployee,updateParentState:this.updateState}),profile?React.createElement(EmployeeProfile,{show_close_btn:true,toggleHandleEmployee:this.toggleHandleEmployee,employee:employee?employee:{},save:this.updateEmployee,changeSection:this.changeSection}):''):\"\";}}]);return EmployeePage;}(Component);function mapStateToProps(_ref4){var employees=_ref4.employees,navbar=_ref4.navbar,assignments=_ref4.assignments,user=_ref4.user,global=_ref4.global;return{employees:employees,navbar:navbar,assignments:assignments,user:user,global:global};}export default withRouter(connect(mapStateToProps,actions)(EmployeePage));","map":{"version":3,"sources":["/Users/denis/Desktop/projects/todo/front/client/src/components/employee-page/EmployeePage.jsx"],"names":["React","Component","withRouter","connect","actions","EmployeeMenu","EmploeeAssignments","apiGetRequest","apiPostRequest","EmployeeProfile","HandleProfile","EmployeePage","changeSection","profile","setState","getEmployee","id","api","res","ok","setTimeout","employee","result","page_loaded","updateEmployee","pw_chaned","resetEmployeePassword","updateState","name","value","toggleHandleEmployee","active","handle_employee","body","_id","password","state","active_section","assignments","props","match","params","user","system_text","global","is_manager","EDIT_EMPLOYEE","mapStateToProps","employees","navbar"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport { withRouter } from \"react-router\";\nimport { connect } from \"react-redux\";\nimport * as actions from \"../../actions/actions\";\nimport EmployeeMenu from \"./parts/EmployeeMenu\";\nimport EmploeeAssignments from \"./employee-assignments/EmploeeAssignments\";\nimport { apiGetRequest, apiPostRequest } from \"../../tools/api\";\nimport EmployeeProfile from \"./employee-assignments/EmployeeProfile\";\nimport HandleProfile from \"../employees/parts/HandleProfile\";\n\nclass EmployeePage extends Component {\n  constructor() {\n    super();\n    this.state = {\n      active_section: \"assignments\",\n      assignments: [],\n    };\n  }\n\n  changeSection = (profile) => {\n    this.setState({\n      profile\n    });\n  };\n\n\n\n  async componentDidMount() {\n    const id = this.props.match.params.id;\n    await this.getEmployee(id);\n  }\n  getEmployee = async (id) => {\n    const api = `employee/get-by-id?id=${id}`;\n    const res = await apiGetRequest(api);\n    if (res.ok) {\n      setTimeout(() => {\n        this.setState({\n          employee: res.result,\n          page_loaded: true,\n        });\n      }, 100);\n    }\n  };\n\n  updateEmployee = async (employee, pw_chaned) => {\n    if (pw_chaned) this.resetEmployeePassword(employee);\n    const api = \"employee/update\";\n    const res = await apiPostRequest(api, employee);\n    if (res.ok) {\n      this.setState({\n        employee: res.result,\n      });\n    }\n  };\n\n  updateState = (name, value) => {\n    this.setState({\n      [name]: value,\n    });\n  };\n\n  toggleHandleEmployee = (active) => {\n    this.setState({\n      handle_employee: active,\n    });\n  };\n\n  resetEmployeePassword = async (profile) => {\n    const api = \"employee/password-reset\";\n    const body = {\n      _id: profile._id,\n      password: profile.password,\n    };\n    await apiPostRequest(api, body);\n  };\n\n  render() {\n    const {\n      employee,\n      active_section,\n      page_loaded,\n      handle_employee,\n      profile\n    } = this.state;\n    const { user } = this.props.user;\n    const { system_text } = this.props.global;\n    return page_loaded && employee ? (\n      <div\n        className=\"employee__page\"\n        id={!user.is_manager ? \"employee__page--employee\" : \"\"}\n      >\n        {handle_employee ? (\n          <HandleProfile\n            toggleHandleProfile={this.toggleHandleEmployee}\n            profile_to_edit={employee}\n            returnEmployee={this.updateEmployee}\n            save={this.updateEmployee}\n            resetPassword={this.resetEmployeePassword}\n            edit_text={system_text.EDIT_EMPLOYEE}\n          />\n        ) : (\n          \"\"\n        )}\n        {user.is_manager ? (\n          <EmployeeMenu\n            system_text={system_text}\n            changeSection={this.changeSection}\n            active_section={active_section}\n            active={true}\n            employee={employee ? employee : {}}\n            user={user}\n          />\n        ) : (\n          \"\"\n        )}\n\n        <EmploeeAssignments\n          hide_page = {profile} \n          employee={employee}\n          updateEmployee={this.updateEmployee}\n          updateParentState={this.updateState}\n        />\n       {profile ?  <EmployeeProfile\n       show_close_btn = {true}\n          toggleHandleEmployee={this.toggleHandleEmployee}\n          employee={employee ? employee : {}}\n          save={this.updateEmployee}\n          changeSection = {this.changeSection}\n        />  : ''}\n      </div>\n    ) : (\n      \"\"\n    );\n  }\n}\n\nfunction mapStateToProps({ employees, navbar, assignments, user, global }) {\n  return { employees, navbar, assignments, user, global };\n}\n\nexport default withRouter(connect(mapStateToProps, actions)(EmployeePage));\n"]},"metadata":{},"sourceType":"module"}