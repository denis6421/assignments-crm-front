{"ast":null,"code":"var _jsxFileName = \"/Users/denis/Desktop/projects/todo/client/src/components/employee-page/employee-assignment-page/EmployeeAssignmentPage.jsx\";\nimport React, { Component } from \"react\";\nimport { withRouter } from \"react-router\";\nimport { apiGetRequest } from \"../../../tools/api\";\nimport { Link } from \"react-router-dom\";\nimport { EMPLOYEE_ROUTE, EMPLOYEE_DASHBOARD_PAGE_ROUTE } from \"../../../tools/routes\";\nimport ArrowBackIcon from \"@material-ui/icons/ArrowBack\";\nimport moment from \"moment\";\nimport { Editor } from \"react-draft-wysiwyg\";\nimport { convertFromRaw, EditorState } from \"draft-js\";\nimport LinkIcon from \"@material-ui/icons/Link\";\nimport ElementActions from \"../../../parts/ElementActions\";\nimport { hasPermission } from \"../../../functions/permission_functions\";\nimport { EDIT_ASSIGNMENTS, DELETE_ASSIGNMENTS } from \"../../settings/categories/permissions/Permissions_keys\";\nimport { connect } from \"react-redux\";\nimport * as actions from \"../../../actions/actions\";\nimport 'moment/locale/he';\n\nclass EmployeeAssignmentPage extends Component {\n  constructor() {\n    super();\n\n    this.changeStatus = status => {\n      const assignment = this.props.assignment;\n      let updated = JSON.parse(JSON.stringify(assignment));\n      updated.status = status;\n      this.props.createAndUpdateAssignment(updated);\n    };\n\n    this.backToList = () => {\n      const user = this.props.user.user;\n      const employee_id = this.state.employee_id;\n\n      if (user.is_manager) {\n        this.props.history.push(EMPLOYEE_ROUTE.replace(\":id\", employee_id));\n      } else {\n        this.props.history.push(EMPLOYEE_DASHBOARD_PAGE_ROUTE.replace(\":id\", employee_id));\n      }\n    };\n\n    this.state = {};\n  }\n\n  async componentWillMount() {\n    const id = this.props.match.params.assignment_id;\n    const employee_id = this.props.match.params.id;\n    console.log(employee_id);\n    const api = \"employee_assignment/get-by-id?_id=\".concat(id);\n    const res = await apiGetRequest(api);\n\n    if (res.ok) {\n      this.props.updateAssignmentInAssignmentPage(res.result);\n      this.setState({\n        employee_id\n      });\n    }\n  }\n\n  render() {\n    const _this$props$global = this.props.global,\n          system_text = _this$props$global.system_text,\n          language = _this$props$global.language;\n    const assignment = this.props.assignment;\n    const _this$props$user = this.props.user,\n          permissions = _this$props$user.permissions,\n          user = _this$props$user.user;\n    let options = [{\n      text: \"EDIT\",\n      function: this.props.handleAssignment,\n      param1: true,\n      param2: false,\n      param3: assignment,\n      disabled: !hasPermission(user, permissions, EDIT_ASSIGNMENTS)\n    }, {\n      text: \"COMMENTS\",\n      function: this.props.handleAssignmentComments,\n      param1: assignment\n    }, {\n      text: \"MARK_AS_PENDING\",\n      function: this.changeStatus,\n      param1: \"pending\"\n    }, {\n      text: \"MARK_AS_DONE\",\n      function: this.changeStatus,\n      param1: \"done\"\n    }, {\n      text: \"MARK_AS_PROGRESS\",\n      function: this.changeStatus,\n      param1: \"in_progress\"\n    }, {\n      text: \"REMOVE\",\n      function: this.props.handleDelete,\n      param1: assignment,\n      disabled: !hasPermission(user, permissions, DELETE_ASSIGNMENTS)\n    }];\n    return assignment ? React.createElement(\"div\", {\n      className: \"employee__assignment__page page__flex\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 104\n      },\n      __self: this\n    }, React.createElement(ElementActions, {\n      width: \"150px\",\n      options: options,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 105\n      },\n      __self: this\n    }), React.createElement(\"header\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 106\n      },\n      __self: this\n    }, React.createElement(\"aside\", {\n      onClick: () => this.backToList(),\n      className: \"flex__start\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 107\n      },\n      __self: this\n    }, React.createElement(ArrowBackIcon, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 110\n      },\n      __self: this\n    }), React.createElement(\"h5\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 111\n      },\n      __self: this\n    }, system_text.ASSIGNMENTS))), React.createElement(\"section\", {\n      className: \"employee__assignment__page__content\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 115\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"employee__assignment__page__content__section\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 116\n      },\n      __self: this\n    }, React.createElement(\"aside\", {\n      className: \"flex__start\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 117\n      },\n      __self: this\n    }, React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 118\n      },\n      __self: this\n    }, system_text.STATUS, \":\"), React.createElement(\"h5\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 119\n      },\n      __self: this\n    }, assignment.status)), React.createElement(\"h3\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 121\n      },\n      __self: this\n    }, system_text.TITLE), React.createElement(\"h2\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 122\n      },\n      __self: this\n    }, assignment.title)), React.createElement(\"aside\", {\n      className: \"employee__assignment__page__content__section\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 124\n      },\n      __self: this\n    }, React.createElement(\"h3\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 125\n      },\n      __self: this\n    }, system_text.CONTENT), assignment.text ? React.createElement(Editor, {\n      toolbarHidden: true,\n      editorState: EditorState.createWithContent(convertFromRaw(JSON.parse(assignment.text))),\n      readOnly: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 127\n      },\n      __self: this\n    }) : \"\"), assignment && assignment.files.length > 0 ? React.createElement(\"div\", {\n      className: \"employee__assignment__page__content__section employee__assignment__page__content__files\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 139\n      },\n      __self: this\n    }, React.createElement(\"h3\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 140\n      },\n      __self: this\n    }, system_text.FILES), React.createElement(\"ul\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 141\n      },\n      __self: this\n    }, assignment.files.map(m => {\n      return React.createElement(\"li\", {\n        className: \"flex__start\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 144\n        },\n        __self: this\n      }, React.createElement(\"a\", {\n        className: \"flex__start\",\n        href: m.url,\n        target: \"_blank\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 145\n        },\n        __self: this\n      }, React.createElement(LinkIcon, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 146\n        },\n        __self: this\n      }), React.createElement(\"h5\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 147\n        },\n        __self: this\n      }, m.name)));\n    }))) : \"\", assignment.deadline ? React.createElement(\"div\", {\n      className: \"employee__assignment__page__content__section\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 158\n      },\n      __self: this\n    }, React.createElement(\"h3\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 159\n      },\n      __self: this\n    }, system_text.DEADLINE), React.createElement(\"span\", {\n      className: \"flex__start\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 160\n      },\n      __self: this\n    }, React.createElement(\"h4\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 161\n      },\n      __self: this\n    }, moment(assignment.deadline).format(\"LLLL\")))) : null, assignment.comments ? React.createElement(\"div\", {\n      className: \"employee__assignment__page__content__section\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 171\n      },\n      __self: this\n    }, React.createElement(\"h3\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 172\n      },\n      __self: this\n    }, system_text.COMMENTS), React.createElement(Editor, {\n      toolbarHidden: true,\n      editorState: EditorState.createWithContent(convertFromRaw(JSON.parse(assignment.comments))),\n      readOnly: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 174\n      },\n      __self: this\n    })) : \" \", React.createElement(\"div\", {\n      className: \"employee__assignment__page__content__section\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 185\n      },\n      __self: this\n    }, React.createElement(\"h3\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 186\n      },\n      __self: this\n    }, system_text.LAST_UPDATED), React.createElement(\"h4\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 187\n      },\n      __self: this\n    }, moment(assignment.updated_at).format(\"DD/MM/YY HH:mm\"))))) : \"\";\n  }\n\n}\n\nfunction mapStateToProps({\n  user,\n  global\n}) {\n  return {\n    user,\n    global\n  };\n}\n\nexport default withRouter(connect(mapStateToProps, actions)(EmployeeAssignmentPage));","map":{"version":3,"sources":["/Users/denis/Desktop/projects/todo/client/src/components/employee-page/employee-assignment-page/EmployeeAssignmentPage.jsx"],"names":["React","Component","withRouter","apiGetRequest","Link","EMPLOYEE_ROUTE","EMPLOYEE_DASHBOARD_PAGE_ROUTE","ArrowBackIcon","moment","Editor","convertFromRaw","EditorState","LinkIcon","ElementActions","hasPermission","EDIT_ASSIGNMENTS","DELETE_ASSIGNMENTS","connect","actions","EmployeeAssignmentPage","constructor","changeStatus","status","assignment","props","updated","JSON","parse","stringify","createAndUpdateAssignment","backToList","user","employee_id","state","is_manager","history","push","replace","componentWillMount","id","match","params","assignment_id","console","log","api","res","ok","updateAssignmentInAssignmentPage","result","setState","render","global","system_text","language","permissions","options","text","function","handleAssignment","param1","param2","param3","disabled","handleAssignmentComments","handleDelete","ASSIGNMENTS","STATUS","TITLE","title","CONTENT","createWithContent","files","length","FILES","map","m","url","name","deadline","DEADLINE","format","comments","COMMENTS","LAST_UPDATED","updated_at","mapStateToProps"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport { withRouter } from \"react-router\";\nimport { apiGetRequest } from \"../../../tools/api\";\nimport { Link } from \"react-router-dom\";\nimport {\n  EMPLOYEE_ROUTE,\n  EMPLOYEE_DASHBOARD_PAGE_ROUTE,\n} from \"../../../tools/routes\";\nimport ArrowBackIcon from \"@material-ui/icons/ArrowBack\";\nimport moment from \"moment\";\nimport { Editor } from \"react-draft-wysiwyg\";\nimport { convertFromRaw, EditorState } from \"draft-js\";\nimport LinkIcon from \"@material-ui/icons/Link\";\nimport ElementActions from \"../../../parts/ElementActions\";\nimport { hasPermission } from \"../../../functions/permission_functions\";\nimport {\n  EDIT_ASSIGNMENTS,\n  DELETE_ASSIGNMENTS,\n} from \"../../settings/categories/permissions/Permissions_keys\";\nimport { connect } from \"react-redux\";\nimport * as actions from \"../../../actions/actions\";\nimport 'moment/locale/he';\n\nclass EmployeeAssignmentPage extends Component {\n  constructor() {\n    super();\n    this.state = {};\n  }\n\n  async componentWillMount() {\n    const id = this.props.match.params.assignment_id;\n    const employee_id = this.props.match.params.id;\n    console.log(employee_id);\n    const api = `employee_assignment/get-by-id?_id=${id}`;\n    const res = await apiGetRequest(api);\n    if (res.ok) {\n      this.props.updateAssignmentInAssignmentPage(res.result);\n      this.setState({\n        employee_id,\n      });\n    }\n  }\n\n  changeStatus = (status) => {\n    const { assignment } = this.props;\n    let updated = JSON.parse(JSON.stringify(assignment));\n    updated.status = status;\n    this.props.createAndUpdateAssignment(updated);\n  };\n\n  backToList = () => {\n    const { user } = this.props.user;\n    const { employee_id } = this.state;\n    if (user.is_manager) {\n      this.props.history.push(EMPLOYEE_ROUTE.replace(\":id\", employee_id));\n    } else {\n      this.props.history.push(\n        EMPLOYEE_DASHBOARD_PAGE_ROUTE.replace(\":id\", employee_id)\n      );\n    }\n  };\n  render() {\n  const {system_text, language} = this.props.global\n    const { assignment  } = this.props;\n    const { permissions, user } = this.props.user;\n\n    let options = [\n      {\n        text: \"EDIT\",\n        function: this.props.handleAssignment,\n        param1: true,\n        param2: false,\n        param3: assignment,\n        disabled: !hasPermission(user, permissions, EDIT_ASSIGNMENTS),\n      },\n      {\n        text: \"COMMENTS\",\n        function: this.props.handleAssignmentComments,\n        param1: assignment,\n      },\n      {\n        text: \"MARK_AS_PENDING\",\n        function: this.changeStatus,\n        param1: \"pending\",\n      },\n      {\n        text: \"MARK_AS_DONE\",\n        function: this.changeStatus,\n        param1: \"done\",\n      },\n      {\n        text: \"MARK_AS_PROGRESS\",\n        function: this.changeStatus,\n        param1: \"in_progress\",\n      },\n      {\n        text: \"REMOVE\",\n        function: this.props.handleDelete,\n        param1: assignment,\n        disabled: !hasPermission(user, permissions, DELETE_ASSIGNMENTS),\n      },\n    ];\n    return assignment ? (\n      <div className=\"employee__assignment__page page__flex\">\n        <ElementActions width=\"150px\" options={options} />\n        <header>\n          <aside\n          onClick = {() => this.backToList()}\n          className=\"flex__start\">\n            <ArrowBackIcon />\n    <h5>{system_text.ASSIGNMENTS}</h5>\n          </aside>\n        </header>\n\n        <section className=\"employee__assignment__page__content\">\n          <div className=\"employee__assignment__page__content__section\">\n            <aside className=\"flex__start\">\n    <p>{system_text.STATUS}:</p>\n              <h5>{assignment.status}</h5>\n            </aside>\n    <h3>{system_text.TITLE}</h3>\n            <h2>{assignment.title}</h2>\n          </div>\n          <aside className=\"employee__assignment__page__content__section\">\n    <h3>{system_text.CONTENT}</h3>\n            {assignment.text ? (\n              <Editor\n                toolbarHidden={true}\n                editorState={EditorState.createWithContent(\n                  convertFromRaw(JSON.parse(assignment.text))\n                )}\n                readOnly={true}\n              />\n            ) : (\n              \"\"\n            )}\n          </aside>\n          {assignment && assignment.files.length > 0 ? (\n            <div className=\"employee__assignment__page__content__section employee__assignment__page__content__files\">\n              <h3>{system_text.FILES}</h3>\n              <ul>\n                {assignment.files.map((m) => {\n                  return (\n                    <li className=\"flex__start\">\n                      <a className=\"flex__start\" href={m.url} target=\"_blank\">\n                        <LinkIcon />\n                        <h5>{m.name}</h5>\n                      </a>\n                    </li>\n                  );\n                })}\n              </ul>\n            </div>\n          ) : (\n            \"\"\n          )}\n          {assignment.deadline ? (\n            <div className=\"employee__assignment__page__content__section\">\n              <h3>{system_text.DEADLINE}</h3>\n             <span className='flex__start'>\n             <h4>\n                {moment(assignment.deadline).format(\"LLLL\")}\n              </h4>\n              {/* <h5>\n               ({moment(assignment.deadline).locale(language.substring(0, 2)).format(\"LLLL\")})\n              </h5> */}\n             </span>\n            </div>\n          ) : null}\n          {assignment.comments ? (\n            <div className=\"employee__assignment__page__content__section\">\n              <h3>{system_text.COMMENTS}</h3>\n\n              <Editor\n                toolbarHidden={true}\n                editorState={EditorState.createWithContent(\n                  convertFromRaw(JSON.parse(assignment.comments))\n                )}\n                readOnly={true}\n              />\n            </div>\n          ) : (\n            \" \"\n          )}\n          <div className=\"employee__assignment__page__content__section\">\n          <h3>{system_text.LAST_UPDATED}</h3>\n            <h4>{moment(assignment.updated_at).format(\"DD/MM/YY HH:mm\")}</h4>\n          </div>\n        </section>\n      </div>\n    ) : (\n      \"\"\n    );\n  }\n}\n\nfunction mapStateToProps({ user, global }) {\n  return { user, global };\n}\n\nexport default withRouter(\n  connect(mapStateToProps, actions)(EmployeeAssignmentPage)\n);\n"]},"metadata":{},"sourceType":"module"}