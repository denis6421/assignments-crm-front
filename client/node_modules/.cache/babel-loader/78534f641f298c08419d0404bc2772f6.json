{"ast":null,"code":"var _jsxFileName = \"/Users/denis/Desktop/projects/todo/front/client/src/components/employee-page/employee-assignment-page/EmployeeAssignmentPage.jsx\";\nimport React, { Component } from \"react\";\nimport { withRouter } from \"react-router\";\nimport { apiGetRequest } from \"../../../tools/api\";\nimport { Link } from \"react-router-dom\";\nimport { EMPLOYEE_ROUTE, EMPLOYEE_DASHBOARD_PAGE_ROUTE } from \"../../../tools/routes\";\nimport ArrowBackIcon from \"@material-ui/icons/ArrowBack\";\nimport moment from \"moment\";\nimport { Editor } from \"react-draft-wysiwyg\";\nimport { convertFromRaw, EditorState } from \"draft-js\";\nimport LinkIcon from \"@material-ui/icons/Link\";\nimport ElementActions from \"../../../parts/ElementActions\";\nimport { hasPermission } from \"../../../functions/permission_functions\";\nimport { EDIT_ASSIGNMENTS, DELETE_ASSIGNMENTS } from \"../../settings/categories/permissions/Permissions_keys\";\nimport { connect } from \"react-redux\";\nimport * as actions from \"../../../actions/actions\";\nimport \"moment/locale/he\";\nimport NavigateBeforeIcon from '@material-ui/icons/NavigateBefore';\n\nclass EmployeeAssignmentPage extends Component {\n  constructor() {\n    super();\n\n    this.changeStatus = status => {\n      const assignment = this.props.assignment;\n      let updated = JSON.parse(JSON.stringify(assignment));\n      updated.status = status;\n      this.props.createAndUpdateAssignment(updated);\n    };\n\n    this.backToList = () => {\n      const user = this.props.user.user;\n      const employee_id = this.state.employee_id;\n\n      if (user.is_manager) {\n        this.props.history.push(EMPLOYEE_ROUTE.replace(\":id\", employee_id));\n      } else {\n        this.props.history.push(EMPLOYEE_DASHBOARD_PAGE_ROUTE.replace(\":id\", employee_id));\n      }\n    };\n\n    this.state = {};\n  }\n\n  async componentWillMount() {\n    const id = this.props.match.params.assignment_id;\n    const employee_id = this.props.match.params.id;\n    setTimeout(() => {\n      this.setState({\n        page_loaded: true\n      });\n    }, 20);\n    const api = \"employee_assignment/get-by-id?_id=\".concat(id);\n    const res = await apiGetRequest(api);\n\n    if (res.ok) {\n      this.props.updateAssignmentInAssignmentPage(res.result);\n      this.setState({\n        employee_id\n      });\n    }\n  }\n\n  render() {\n    const _this$props$global = this.props.global,\n          system_text = _this$props$global.system_text,\n          language = _this$props$global.language;\n    const assignment = this.props.assignment;\n    const _this$props$user = this.props.user,\n          permissions = _this$props$user.permissions,\n          user = _this$props$user.user;\n    const page_loaded = this.state.page_loaded;\n    let options = [{\n      text: \"EDIT\",\n      function: this.props.handleAssignment,\n      param1: true,\n      param2: false,\n      param3: assignment,\n      disabled: !hasPermission(user, permissions, EDIT_ASSIGNMENTS)\n    }, {\n      text: \"COMMENTS\",\n      function: this.props.handleAssignmentComments,\n      param1: assignment\n    }, {\n      text: \"MARK_AS_PENDING\",\n      function: this.changeStatus,\n      param1: \"pending\"\n    }, {\n      text: \"MARK_AS_DONE\",\n      function: this.changeStatus,\n      param1: \"done\"\n    }, {\n      text: \"MARK_AS_PROGRESS\",\n      function: this.changeStatus,\n      param1: \"in_progress\"\n    }, {\n      text: \"REMOVE\",\n      function: this.props.handleDelete,\n      param1: assignment,\n      disabled: !hasPermission(user, permissions, DELETE_ASSIGNMENTS)\n    }];\n    return React.createElement(\"div\", {\n      style: {\n        opacity: page_loaded ? 1 : 0\n      },\n      className: \"employee__assignment__page page__flex\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 112\n      },\n      __self: this\n    }, React.createElement(ElementActions, {\n      width: \"150px\",\n      options: options,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 117\n      },\n      __self: this\n    }), React.createElement(\"header\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 118\n      },\n      __self: this\n    }, React.createElement(\"aside\", {\n      onClick: () => this.backToList(),\n      className: \"flex__start\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 119\n      },\n      __self: this\n    }, React.createElement(NavigateBeforeIcon, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 120\n      },\n      __self: this\n    }), React.createElement(\"h5\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 121\n      },\n      __self: this\n    }, system_text.ASSIGNMENTS))), React.createElement(\"section\", {\n      className: \"employee__assignment__page__content\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 125\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"employee__assignment__page__content__section\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 126\n      },\n      __self: this\n    }, React.createElement(\"aside\", {\n      className: \"flex__start\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 127\n      },\n      __self: this\n    }, React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 128\n      },\n      __self: this\n    }, system_text.STATUS, \":\"), React.createElement(\"h5\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 129\n      },\n      __self: this\n    }, system_text[assignment.status])), React.createElement(\"h3\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 131\n      },\n      __self: this\n    }, system_text.TITLE), React.createElement(\"h4\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 132\n      },\n      __self: this\n    }, assignment.title)), React.createElement(\"aside\", {\n      className: \"employee__assignment__page__content__section\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 134\n      },\n      __self: this\n    }, React.createElement(\"h3\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 135\n      },\n      __self: this\n    }, system_text.CONTENT), assignment.text ? React.createElement(Editor, {\n      toolbarHidden: true,\n      editorState: EditorState.createWithContent(convertFromRaw(JSON.parse(assignment.text))),\n      readOnly: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 137\n      },\n      __self: this\n    }) : \"\"), assignment && assignment.files.length > 0 ? React.createElement(\"div\", {\n      className: \"employee__assignment__page__content__section employee__assignment__page__content__files\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 149\n      },\n      __self: this\n    }, React.createElement(\"h3\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 150\n      },\n      __self: this\n    }, system_text.FILES), React.createElement(\"ul\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 151\n      },\n      __self: this\n    }, assignment.files.map(m => {\n      return React.createElement(\"li\", {\n        className: \"flex__start\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 154\n        },\n        __self: this\n      }, React.createElement(\"a\", {\n        className: \"flex__start\",\n        href: m.url,\n        target: \"_blank\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 155\n        },\n        __self: this\n      }, React.createElement(LinkIcon, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 156\n        },\n        __self: this\n      }), React.createElement(\"h5\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 157\n        },\n        __self: this\n      }, m.name)));\n    }))) : \"\", assignment.deadline ? React.createElement(\"div\", {\n      className: \"employee__assignment__page__content__section\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 168\n      },\n      __self: this\n    }, React.createElement(\"h3\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 169\n      },\n      __self: this\n    }, system_text.DEADLINE), React.createElement(\"span\", {\n      className: \"flex__start\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 170\n      },\n      __self: this\n    }, React.createElement(\"h4\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 171\n      },\n      __self: this\n    }, moment(assignment.deadline).locale(language.substring(0, 2)).format(\"dddd, LL\")))) : null, assignment.comments ? React.createElement(\"div\", {\n      className: \"employee__assignment__page__content__section\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 180\n      },\n      __self: this\n    }, React.createElement(\"h3\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 181\n      },\n      __self: this\n    }, system_text.COMMENTS), React.createElement(Editor, {\n      toolbarHidden: true,\n      editorState: EditorState.createWithContent(convertFromRaw(JSON.parse(assignment.comments))),\n      readOnly: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 183\n      },\n      __self: this\n    })) : \" \", React.createElement(\"div\", {\n      className: \"employee__assignment__page__content__section\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 194\n      },\n      __self: this\n    }, React.createElement(\"h3\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 195\n      },\n      __self: this\n    }, system_text.LAST_UPDATED), React.createElement(\"h4\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 196\n      },\n      __self: this\n    }, moment(assignment.updated_at).format(\"DD/MM/YY HH:mm\")))));\n  }\n\n}\n\nfunction mapStateToProps({\n  user,\n  global\n}) {\n  return {\n    user,\n    global\n  };\n}\n\nexport default withRouter(connect(mapStateToProps, actions)(EmployeeAssignmentPage));","map":{"version":3,"sources":["/Users/denis/Desktop/projects/todo/front/client/src/components/employee-page/employee-assignment-page/EmployeeAssignmentPage.jsx"],"names":["React","Component","withRouter","apiGetRequest","Link","EMPLOYEE_ROUTE","EMPLOYEE_DASHBOARD_PAGE_ROUTE","ArrowBackIcon","moment","Editor","convertFromRaw","EditorState","LinkIcon","ElementActions","hasPermission","EDIT_ASSIGNMENTS","DELETE_ASSIGNMENTS","connect","actions","NavigateBeforeIcon","EmployeeAssignmentPage","constructor","changeStatus","status","assignment","props","updated","JSON","parse","stringify","createAndUpdateAssignment","backToList","user","employee_id","state","is_manager","history","push","replace","componentWillMount","id","match","params","assignment_id","setTimeout","setState","page_loaded","api","res","ok","updateAssignmentInAssignmentPage","result","render","global","system_text","language","permissions","options","text","function","handleAssignment","param1","param2","param3","disabled","handleAssignmentComments","handleDelete","opacity","ASSIGNMENTS","STATUS","TITLE","title","CONTENT","createWithContent","files","length","FILES","map","m","url","name","deadline","DEADLINE","locale","substring","format","comments","COMMENTS","LAST_UPDATED","updated_at","mapStateToProps"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport { withRouter } from \"react-router\";\nimport { apiGetRequest } from \"../../../tools/api\";\nimport { Link } from \"react-router-dom\";\nimport {\n  EMPLOYEE_ROUTE,\n  EMPLOYEE_DASHBOARD_PAGE_ROUTE,\n} from \"../../../tools/routes\";\nimport ArrowBackIcon from \"@material-ui/icons/ArrowBack\";\nimport moment from \"moment\";\nimport { Editor } from \"react-draft-wysiwyg\";\nimport { convertFromRaw, EditorState } from \"draft-js\";\nimport LinkIcon from \"@material-ui/icons/Link\";\nimport ElementActions from \"../../../parts/ElementActions\";\nimport { hasPermission } from \"../../../functions/permission_functions\";\nimport {\n  EDIT_ASSIGNMENTS,\n  DELETE_ASSIGNMENTS,\n} from \"../../settings/categories/permissions/Permissions_keys\";\nimport { connect } from \"react-redux\";\nimport * as actions from \"../../../actions/actions\";\nimport \"moment/locale/he\";\nimport NavigateBeforeIcon from '@material-ui/icons/NavigateBefore';\n\n\nclass EmployeeAssignmentPage extends Component {\n  constructor() {\n    super();\n    this.state = {\n    };\n  }\n\n  async componentWillMount() {\n    const id = this.props.match.params.assignment_id;\n    const employee_id = this.props.match.params.id;\n\n   setTimeout(() => {\n      this.setState({\n        page_loaded:true\n      })\n   }, 20);\n    const api = `employee_assignment/get-by-id?_id=${id}`;\n    const res = await apiGetRequest(api);\n    if (res.ok) {\n      this.props.updateAssignmentInAssignmentPage(res.result);\n      this.setState({\n        employee_id,\n      });\n    }\n  }\n\n  changeStatus = (status) => {\n    const { assignment } = this.props;\n    let updated = JSON.parse(JSON.stringify(assignment));\n    updated.status = status;\n    this.props.createAndUpdateAssignment(updated);\n  };\n\n  backToList = () => {\n    const { user } = this.props.user;\n    const { employee_id } = this.state;\n    if (user.is_manager) {\n      this.props.history.push(EMPLOYEE_ROUTE.replace(\":id\", employee_id));\n    } else {\n      this.props.history.push(\n        EMPLOYEE_DASHBOARD_PAGE_ROUTE.replace(\":id\", employee_id)\n      );\n    }\n  };\n  render() {\n    const { system_text, language } = this.props.global;\n    const { assignment } = this.props;\n    const { permissions, user } = this.props.user;\n    const {page_loaded} = this.state\n    let options = [\n      {\n        text: \"EDIT\",\n        function: this.props.handleAssignment,\n        param1: true,\n        param2: false,\n        param3: assignment,\n        disabled: !hasPermission(user, permissions, EDIT_ASSIGNMENTS),\n      },\n      {\n        text: \"COMMENTS\",\n        function: this.props.handleAssignmentComments,\n        param1: assignment,\n      },\n      {\n        text: \"MARK_AS_PENDING\",\n        function: this.changeStatus,\n        param1: \"pending\",\n      },\n      {\n        text: \"MARK_AS_DONE\",\n        function: this.changeStatus,\n        param1: \"done\",\n      },\n      {\n        text: \"MARK_AS_PROGRESS\",\n        function: this.changeStatus,\n        param1: \"in_progress\",\n      },\n      {\n        text: \"REMOVE\",\n        function: this.props.handleDelete,\n        param1: assignment,\n        disabled: !hasPermission(user, permissions, DELETE_ASSIGNMENTS),\n      },\n    ];\n    return  (\n      <div \n      style ={{\n        opacity:page_loaded ? 1  :0\n      }}\n      className=\"employee__assignment__page page__flex\">\n        <ElementActions width=\"150px\" options={options} />\n        <header>\n          <aside onClick={() => this.backToList()} className=\"flex__start\">\n            <NavigateBeforeIcon />\n            <h5>{system_text.ASSIGNMENTS}</h5>\n          </aside>\n        </header>\n\n        <section className=\"employee__assignment__page__content\">\n          <div className=\"employee__assignment__page__content__section\">\n            <aside className=\"flex__start\">\n              <p>{system_text.STATUS}:</p>\n              <h5>{system_text[assignment.status]}</h5>\n            </aside>\n            <h3>{system_text.TITLE}</h3>\n            <h4>{assignment.title}</h4>\n          </div>\n          <aside className=\"employee__assignment__page__content__section\">\n            <h3>{system_text.CONTENT}</h3>\n            {assignment.text ? (\n              <Editor\n                toolbarHidden={true}\n                editorState={EditorState.createWithContent(\n                  convertFromRaw(JSON.parse(assignment.text))\n                )}\n                readOnly={true}\n              />\n            ) : (\n              \"\"\n            )}\n          </aside>\n          {assignment && assignment.files.length > 0 ? (\n            <div className=\"employee__assignment__page__content__section employee__assignment__page__content__files\">\n              <h3>{system_text.FILES}</h3>\n              <ul>\n                {assignment.files.map((m) => {\n                  return (\n                    <li className=\"flex__start\">\n                      <a className=\"flex__start\" href={m.url} target=\"_blank\">\n                        <LinkIcon />\n                        <h5>{m.name}</h5>\n                      </a>\n                    </li>\n                  );\n                })}\n              </ul>\n            </div>\n          ) : (\n            \"\"\n          )}\n          {assignment.deadline ? (\n            <div className=\"employee__assignment__page__content__section\">\n              <h3>{system_text.DEADLINE}</h3>\n              <span className=\"flex__start\">\n                <h4>\n                  {moment(assignment.deadline)\n                    .locale(language.substring(0, 2))\n                    .format(\"dddd, LL\")}\n                </h4>\n              </span>\n            </div>\n          ) : null}\n          {assignment.comments ? (\n            <div className=\"employee__assignment__page__content__section\">\n              <h3>{system_text.COMMENTS}</h3>\n\n              <Editor\n                toolbarHidden={true}\n                editorState={EditorState.createWithContent(\n                  convertFromRaw(JSON.parse(assignment.comments))\n                )}\n                readOnly={true}\n              />\n            </div>\n          ) : (\n            \" \"\n          )}\n          <div className=\"employee__assignment__page__content__section\">\n            <h3>{system_text.LAST_UPDATED}</h3>\n            <h4>{moment(assignment.updated_at).format(\"DD/MM/YY HH:mm\")}</h4>\n          </div>\n        </section>\n      </div>\n    ) \n  }\n}\n\nfunction mapStateToProps({ user, global }) {\n  return { user, global };\n}\n\nexport default withRouter(\n  connect(mapStateToProps, actions)(EmployeeAssignmentPage)\n);\n"]},"metadata":{},"sourceType":"module"}