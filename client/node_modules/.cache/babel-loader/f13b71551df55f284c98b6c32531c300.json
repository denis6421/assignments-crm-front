{"ast":null,"code":"import _regeneratorRuntime from\"/Users/denis/Desktop/projects/todo/front/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/denis/Desktop/projects/todo/front/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/Users/denis/Desktop/projects/todo/front/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/denis/Desktop/projects/todo/front/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/Users/denis/Desktop/projects/todo/front/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/Users/denis/Desktop/projects/todo/front/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/Users/denis/Desktop/projects/todo/front/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import React,{Component}from\"react\";import{connect}from\"react-redux\";import*as actions from\"../../../../actions/actions\";import{withRouter}from\"react-router\";import{apiGetRequest,apiPostRequest}from\"../../../../tools/api\";import HandleProfile from\"../../../employees/parts/HandleProfile\";import EmployeeProfile from\"../../../employee-page/employee-assignments/EmployeeProfile\";import{SETTINGS_ROUTE,EMPLOYEE_DASHBOARD_SETTINGS}from\"../../../../tools/routes\";import NavigateBeforeIcon from\"@material-ui/icons/NavigateBefore\";import{Link}from\"react-router-dom\";var ProfileSettings=/*#__PURE__*/function(_Component){_inherits(ProfileSettings,_Component);function ProfileSettings(){var _this;_classCallCheck(this,ProfileSettings);_this=_possibleConstructorReturn(this,_getPrototypeOf(ProfileSettings).call(this));_this.getProfile=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var user,api,res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:user=_this.props.user.user;api=\"\";if(user.is_manager)api=\"users/get-profile\";else api=\"employee/get-profile\";_context.next=5;return apiGetRequest(api);case 5:res=_context.sent;if(res.ok){_this.setState({profile:res.result});}case 7:case\"end\":return _context.stop();}}},_callee);}));_this.saveProfile=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(profile,pw_changed){var user,api,res;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:user=_this.props.user.user;api=\"\";if(user.is_manager)api=\"users/update\";else api=\"employee/update\";_context2.next=5;return apiPostRequest(api,profile);case 5:res=_context2.sent;if(res.ok){_this.props.updateUserReducer(\"user\",res.result);_this.setState({profile:profile});}if(pw_changed){_this.resetProfilePassword(profile);}case 8:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x,_x2){return _ref2.apply(this,arguments);};}();_this.resetProfilePassword=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(profile){var user,api,body;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:user=_this.props.user.user;api=\"\";body={password:profile.password};if(user.is_manager){api=\"users/reset-password\";}else{body[\"_id\"]=profile._id;api=\"employee/reset-password\";}_context3.next=6;return apiPostRequest(api,body);case 6:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x3){return _ref3.apply(this,arguments);};}();_this.toggleHandleProfile=function(val){_this.setState({edit_profile:val});};_this.state={edit_profile:false};return _this;}_createClass(ProfileSettings,[{key:\"componentDidMount\",value:function(){var _componentDidMount=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:this.getProfile();case 1:case\"end\":return _context4.stop();}}},_callee4,this);}));function componentDidMount(){return _componentDidMount.apply(this,arguments);}return componentDidMount;}()},{key:\"render\",value:function render(){var _this$state=this.state,profile=_this$state.profile,edit_profile=_this$state.edit_profile;var user=this.props.user.user;var system_text=this.props.global.system_text;return profile?React.createElement(\"div\",{className:\"settings__profile\"},React.createElement(\"header\",null,React.createElement(Link,{className:\"back__button flex__start\",to:user.is_manager?SETTINGS_ROUTE:EMPLOYEE_DASHBOARD_SETTINGS},React.createElement(NavigateBeforeIcon,null),system_text.SETTINGS)),React.createElement(EmployeeProfile,{employee:profile,toggleHandleEmployee:this.toggleHandleProfile,hide_status:true}),edit_profile?React.createElement(HandleProfile,{profile_to_edit:profile,save:this.saveProfile,resetPassword:this.resetProfilePassword,toggleHandleProfile:this.toggleHandleProfile,edit_text:\"Edit profile\",status_disabled:true}):null):null;}}]);return ProfileSettings;}(Component);function mapStateToProps(_ref4){var user=_ref4.user,global=_ref4.global;return{user:user,global:global};}export default withRouter(connect(mapStateToProps,actions)(ProfileSettings));","map":{"version":3,"sources":["/Users/denis/Desktop/projects/todo/front/client/src/components/settings/categories/profile/ProfileSettings.jsx"],"names":["React","Component","connect","actions","withRouter","apiGetRequest","apiPostRequest","HandleProfile","EmployeeProfile","SETTINGS_ROUTE","EMPLOYEE_DASHBOARD_SETTINGS","NavigateBeforeIcon","Link","ProfileSettings","getProfile","user","props","api","is_manager","res","ok","setState","profile","result","saveProfile","pw_changed","updateUserReducer","resetProfilePassword","body","password","_id","toggleHandleProfile","val","edit_profile","state","system_text","global","SETTINGS","mapStateToProps"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport { connect } from \"react-redux\";\nimport * as actions from \"../../../../actions/actions\";\nimport { withRouter } from \"react-router\";\nimport { apiGetRequest, apiPostRequest } from \"../../../../tools/api\";\nimport HandleProfile from \"../../../employees/parts/HandleProfile\";\nimport EmployeeProfile from \"../../../employee-page/employee-assignments/EmployeeProfile\";\nimport {\n  SETTINGS_ROUTE,\n  EMPLOYEE_DASHBOARD_SETTINGS,\n} from \"../../../../tools/routes\";\nimport NavigateBeforeIcon from \"@material-ui/icons/NavigateBefore\";\nimport { Link } from \"react-router-dom\";\nclass ProfileSettings extends Component {\n  constructor() {\n    super();\n    this.state = {\n      edit_profile: false,\n    };\n  }\n\n  async componentDidMount() {\n    this.getProfile();\n  }\n  getProfile = async () => {\n    const { user } = this.props.user;\n    let api = \"\";\n    if (user.is_manager) api = \"users/get-profile\";\n    else api = \"employee/get-profile\";\n    const res = await apiGetRequest(api);\n    if (res.ok) {\n      this.setState({ profile: res.result });\n    }\n  };\n  saveProfile = async (profile, pw_changed) => {\n    const { user } = this.props.user;\n    let api = \"\";\n    if (user.is_manager) api = \"users/update\";\n    else api = \"employee/update\";\n    const res = await apiPostRequest(api, profile);\n    if (res.ok) {\n   \n      this.props.updateUserReducer(\"user\", res.result);\n      this.setState({\n        profile,\n      });\n    }\n    if (pw_changed) {\n      this.resetProfilePassword(profile);\n    }\n  };\n\n  resetProfilePassword = async (profile) => {\n    const { user } = this.props.user;\n    let api = \"\";\n    let body = {\n      password: profile.password,\n    };\n    if (user.is_manager) {\n      api = \"users/reset-password\";\n    } else {\n      body[\"_id\"] = profile._id;\n      api = \"employee/reset-password\";\n    }\n    await apiPostRequest(api, body);\n  };\n  toggleHandleProfile = (val) => {\n    this.setState({\n      edit_profile: val,\n    });\n  };\n  render() {\n    const { profile, edit_profile } = this.state;\n    const { user } = this.props.user;\n    const { system_text } = this.props.global;\n    return profile ? (\n      <div className=\"settings__profile\">\n        <header>\n          <Link\n            className=\"back__button flex__start\"\n            to={user.is_manager ? SETTINGS_ROUTE : EMPLOYEE_DASHBOARD_SETTINGS}\n          >\n            <NavigateBeforeIcon />\n            {system_text.SETTINGS}\n          </Link>\n        </header>\n        <EmployeeProfile\n          employee={profile}\n          toggleHandleEmployee={this.toggleHandleProfile}\n          hide_status={true}\n        />\n        {edit_profile ? (\n          <HandleProfile\n            profile_to_edit={profile}\n            save={this.saveProfile}\n            resetPassword={this.resetProfilePassword}\n            toggleHandleProfile={this.toggleHandleProfile}\n            edit_text={\"Edit profile\"}\n            status_disabled={true}\n          />\n        ) : null}\n      </div>\n    ) : null;\n  }\n}\n\nfunction mapStateToProps({ user, global }) {\n  return { user, global };\n}\n\nexport default withRouter(connect(mapStateToProps, actions)(ProfileSettings));\n"]},"metadata":{},"sourceType":"module"}