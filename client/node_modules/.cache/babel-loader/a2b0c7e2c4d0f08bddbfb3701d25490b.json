{"ast":null,"code":"import _toConsumableArray from\"/Users/denis/Desktop/projects/todo/front/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _defineProperty from\"/Users/denis/Desktop/projects/todo/front/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _classCallCheck from\"/Users/denis/Desktop/projects/todo/front/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/denis/Desktop/projects/todo/front/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/Users/denis/Desktop/projects/todo/front/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/Users/denis/Desktop/projects/todo/front/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/Users/denis/Desktop/projects/todo/front/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import React,{Component}from\"react\";import{connect}from\"react-redux\";import*as actions from\"../../../actions/actions\";import{withRouter}from\"react-router\";import EmployeeAssignment from\"./EmployeeAssignment\";import AssignmentLoader from\"../../assignments/parts/AssignmentLoader\";import{hasPermission}from\"../../../functions/permission_functions\";import{CREATE_ASSIGNMENTS}from\"../../settings/categories/permissions/Permissions_keys\";import{filterEmployeeAssignments}from\"../../../functions/employe_assignments_functions\";import NoData from\"../../../parts/NoData\";import LibraryAddOutlinedIcon from\"@material-ui/icons/LibraryAddOutlined\";import BtnWithTooltip from\"../../../parts/BtnWithTooltip\";import SortIcon from\"@material-ui/icons/Sort\";import moment from\"moment\";var getAssignmentsAmount=function getAssignmentsAmount(arr,value){if(arr&&arr.length>0){var num=0;arr.forEach(function(element){if(element.status===value){num++;}});return num;}else{return 0;}};var EmployeeTodoList=/*#__PURE__*/function(_Component){_inherits(EmployeeTodoList,_Component);function EmployeeTodoList(){var _this;_classCallCheck(this,EmployeeTodoList);_this=_possibleConstructorReturn(this,_getPrototypeOf(EmployeeTodoList).call(this));_this.handleFilter=function(val){_this.setState({status:val});};_this.toggleAssignmentsList=function(val){_this.setState({show_assignments:val});};_this.updateState=function(name,value){_this.setState(_defineProperty({},name,value));};_this.openCreateAssignment=function(){_this.props.handleAssignment(true,true);};_this.sortAssignments=function(){var sort=_this.state.sort;_this.setState({sort:!sort});};_this.state={status:\"pending\"};return _this;}_createClass(EmployeeTodoList,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;setTimeout(function(){_this2.setState({page_loaded:true});},20);}},{key:\"componentWillUnmount\",value:function componentWillUnmount(){this.toggleAssignmentsList(false);}},{key:\"render\",value:function render(){var _this3=this;var _this$props=this.props,employee=_this$props.employee,assignments_loaded=_this$props.assignments_loaded,manager_assignments=_this$props.manager_assignments;var _this$props$user=this.props.user,user=_this$props$user.user,permissions=_this$props$user.permissions;var _this$state=this.state,status=_this$state.status,page_loaded=_this$state.page_loaded,sort=_this$state.sort;var system_text=this.props.global.system_text;return React.createElement(\"div\",{style:{opacity:page_loaded?1:0},className:\"employee__page__assignments\"},React.createElement(\"div\",{className:\"sticky__top\"},React.createElement(\"header\",{className:\"employee__page__assignments__header flex__start\"},hasPermission(user,permissions,CREATE_ASSIGNMENTS)?React.createElement(BtnWithTooltip,{svg:React.createElement(LibraryAddOutlinedIcon,null),handleClick:function handleClick(){return _this3.props.handleAssignment(true);},tooltip:system_text.CREATE}):\"\"),React.createElement(\"ul\",{className:\"flex__start\",id:\"employee__page__assignments__actions\"},system_text.ASSIGNMENT_STATUS_ARR.map(function(m,i){return React.createElement(\"li\",{key:i,className:\"flex__center\",id:status===m.value?\"employee__page__assignments__actions--active\":\"\",onClick:function onClick(){return _this3.handleFilter(m.value);}},m.img,React.createElement(\"h3\",null,\" \",m.text),React.createElement(\"h5\",null,\"(\",getAssignmentsAmount(employee.assignments,m.value),\")\"));})),filterEmployeeAssignments(employee.assignments,status)?React.createElement(\"section\",{id:\"employee__assignments__titles\",className:\"flex__start\"},system_text.EMPLOYEE_ASSIGNMENTS_TITLES.map(function(m,i){return React.createElement(\"div\",{className:\"flex__start\",key:i},React.createElement(\"h3\",null,m.name),m.value===\"deadline\"?React.createElement(SortIcon,{onClick:function onClick(){return _this3.sortAssignments();}}):\"\");})):null),React.createElement(\"ul\",{className:\"flex__start\",id:\"employee__assignments\"},!assignments_loaded?React.createElement(AssignmentLoader,{arr:_toConsumableArray(Array(3).keys())}):assignments_loaded&&!filterEmployeeAssignments(employee.assignments,status)?React.createElement(NoData,{create:this.openCreateAssignment,text:system_text.NO_ASSIGNMENTS}):employee.assignments&&employee.assignments.length>0?filterEmployeeAssignments(employee.assignments,status,sort).map(function(m){var _React$createElement;return React.createElement(EmployeeAssignment,(_React$createElement={key:m._id,m:m,manager_assignments:manager_assignments,createAndUpdateAssignment:_this3.props.createAndUpdateAssignment,handleAssignment:_this3.props.handleAssignment,handleDelete:_this3.props.handleDelete},_defineProperty(_React$createElement,\"key\",m._id),_defineProperty(_React$createElement,\"handleAssignmentComments\",_this3.props.handleAssignmentComments),_React$createElement));}):\"\"));}}]);return EmployeeTodoList;}(Component);function mapStateToProps(_ref){var employees=_ref.employees,assignments=_ref.assignments,user=_ref.user,global=_ref.global;return{employees:employees,assignments:assignments,user:user,global:global};}export default withRouter(connect(mapStateToProps,actions)(EmployeeTodoList));","map":{"version":3,"sources":["/Users/denis/Desktop/projects/todo/front/client/src/components/employee-page/employee-assignments/EmployeeTodoList.jsx"],"names":["React","Component","connect","actions","withRouter","EmployeeAssignment","AssignmentLoader","hasPermission","CREATE_ASSIGNMENTS","filterEmployeeAssignments","NoData","LibraryAddOutlinedIcon","BtnWithTooltip","SortIcon","moment","getAssignmentsAmount","arr","value","length","num","forEach","element","status","EmployeeTodoList","handleFilter","val","setState","toggleAssignmentsList","show_assignments","updateState","name","openCreateAssignment","props","handleAssignment","sortAssignments","sort","state","setTimeout","page_loaded","employee","assignments_loaded","manager_assignments","user","permissions","system_text","global","opacity","CREATE","ASSIGNMENT_STATUS_ARR","map","m","i","img","text","assignments","EMPLOYEE_ASSIGNMENTS_TITLES","Array","keys","NO_ASSIGNMENTS","_id","createAndUpdateAssignment","handleDelete","handleAssignmentComments","mapStateToProps","employees"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport { connect } from \"react-redux\";\nimport * as actions from \"../../../actions/actions\";\nimport { withRouter } from \"react-router\";\nimport EmployeeAssignment from \"./EmployeeAssignment\";\nimport AssignmentLoader from \"../../assignments/parts/AssignmentLoader\";\nimport { hasPermission } from \"../../../functions/permission_functions\";\nimport { CREATE_ASSIGNMENTS } from \"../../settings/categories/permissions/Permissions_keys\";\nimport { filterEmployeeAssignments } from \"../../../functions/employe_assignments_functions\";\nimport NoData from \"../../../parts/NoData\";\nimport LibraryAddOutlinedIcon from \"@material-ui/icons/LibraryAddOutlined\";\nimport BtnWithTooltip from \"../../../parts/BtnWithTooltip\";\nimport SortIcon from \"@material-ui/icons/Sort\";\nimport moment from \"moment\";\nconst getAssignmentsAmount = (arr, value) => {\n  if (arr && arr.length > 0) {\n    let num = 0;\n    arr.forEach((element) => {\n      if (element.status === value) {\n        num++;\n      }\n    });\n    return num;\n  } else {\n    return 0;\n  }\n};\n\nclass EmployeeTodoList extends Component {\n  constructor() {\n    super();\n    this.state = {\n      status: \"pending\",\n    };\n  }\n  componentDidMount() {\n    setTimeout(() => {\n      this.setState({\n        page_loaded: true,\n      });\n    }, 20);\n  }\n  handleFilter = (val) => {\n    this.setState({\n      status: val,\n    });\n  };\n  componentWillUnmount() {\n    this.toggleAssignmentsList(false);\n  }\n  toggleAssignmentsList = (val) => {\n    this.setState({\n      show_assignments: val,\n    });\n  };\n\n  updateState = (name, value) => {\n    this.setState({\n      [name]: value,\n    });\n  };\n  openCreateAssignment = () => {\n    this.props.handleAssignment(true, true);\n  };\n\n  sortAssignments = () => {\n    const { sort } = this.state;\n    this.setState({\n      sort: !sort,\n    });\n  };\n  render() {\n    const { employee, assignments_loaded, manager_assignments } = this.props;\n    const { user, permissions } = this.props.user;\n    const { status, page_loaded, sort } = this.state;\n    const { system_text } = this.props.global;\n    return (\n      <div\n        style={{\n          opacity: page_loaded ? 1 : 0,\n        }}\n        className=\"employee__page__assignments\"\n      >\n        <div className=\"sticky__top\">\n          <header className=\"employee__page__assignments__header flex__start\">\n            {hasPermission(user, permissions, CREATE_ASSIGNMENTS) ? (\n              <BtnWithTooltip\n                svg={<LibraryAddOutlinedIcon />}\n                handleClick={() => this.props.handleAssignment(true)}\n                tooltip={system_text.CREATE}\n              />\n            ) : (\n              \"\"\n            )}\n          </header>\n          <ul className=\"flex__start\" id=\"employee__page__assignments__actions\">\n            {system_text.ASSIGNMENT_STATUS_ARR.map((m, i) => {\n              return (\n                <li\n                  key={i}\n                  className=\"flex__center\"\n                  id={\n                    status === m.value\n                      ? \"employee__page__assignments__actions--active\"\n                      : \"\"\n                  }\n                  onClick={() => this.handleFilter(m.value)}\n                >\n                  {m.img}\n                  <h3> {m.text}</h3>\n                  <h5>\n                    ({getAssignmentsAmount(employee.assignments, m.value)})\n                  </h5>\n                </li>\n              );\n            })}\n          </ul>\n          {filterEmployeeAssignments(employee.assignments, status) ? (\n            <section id=\"employee__assignments__titles\" className=\"flex__start\">\n              {system_text.EMPLOYEE_ASSIGNMENTS_TITLES.map((m, i) => {\n                return (\n                  <div className=\"flex__start\" key={i}>\n                    <h3>{m.name}</h3>\n                    {m.value === \"deadline\" ? (\n                      <SortIcon onClick={() => this.sortAssignments()} />\n                    ) : (\n                      \"\"\n                    )}\n                  </div>\n                );\n              })}\n            </section>\n          ) : null}\n        </div>\n\n        <ul className=\"flex__start\" id=\"employee__assignments\">\n          {!assignments_loaded ? (\n            <AssignmentLoader arr={[...Array(3).keys()]} />\n          ) : assignments_loaded &&\n            !filterEmployeeAssignments(employee.assignments, status) ? (\n            <NoData\n              create={this.openCreateAssignment}\n              text={system_text.NO_ASSIGNMENTS}\n            />\n          ) : employee.assignments && employee.assignments.length > 0 ? (\n            filterEmployeeAssignments(employee.assignments, status, sort).map(\n              (m) => {\n                return (\n                  <EmployeeAssignment\n                    key={m._id}\n                    m={m}\n                    manager_assignments={manager_assignments}\n                    createAndUpdateAssignment={\n                      this.props.createAndUpdateAssignment\n                    }\n                    handleAssignment={this.props.handleAssignment}\n                    handleDelete={this.props.handleDelete}\n                    key={m._id}\n                    handleAssignmentComments={\n                      this.props.handleAssignmentComments\n                    }\n                  />\n                );\n              }\n            )\n          ) : (\n            \"\"\n          )}\n        </ul>\n      </div>\n    );\n  }\n}\n\nfunction mapStateToProps({ employees, assignments, user, global }) {\n  return { employees, assignments, user, global };\n}\n\nexport default withRouter(connect(mapStateToProps, actions)(EmployeeTodoList));\n"]},"metadata":{},"sourceType":"module"}