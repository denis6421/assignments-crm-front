{"ast":null,"code":"var _jsxFileName = \"/Users/denis/Desktop/projects/todo/front/client/src/components/assignments/parts/HandleAssignment.jsx\";\nimport React, { Component } from \"react\";\nimport assignments_inputs_data from \"./assignments_inputs_data\";\nimport TextInput from \"../../../parts/inputs/TextInput\";\nimport { connect } from \"react-redux\";\nimport * as actions from \"../../../actions/actions\";\nimport DraftInput from \"../../../parts/inputs/DraftInput\";\nimport CloseIcon from \"@material-ui/icons/Close\";\nimport FilesUpload from \"../../../parts/FilesUpload\";\nimport SubmitButtons from \"../../../parts/SubmitButtons\";\nimport EmployeeAssignmentsPopup from \"../../employee-page/employee-assignments/EmployeeAssignmentsPopup\";\nimport MaterialDatepicker from \"../../../parts/MaterialDatepicker\";\n\nclass HandleAssignment extends Component {\n  constructor() {\n    super();\n\n    this.updateStateAssignment = (name, value) => {\n      const assignment = this.state.assignment;\n      let new_assignment = JSON.parse(JSON.stringify(assignment));\n      new_assignment[name] = value;\n      this.setState({\n        assignment: new_assignment\n      });\n    };\n\n    this.submitForm = async e => {\n      const _this$state = this.state,\n            is_edit = _this$state.is_edit,\n            assignment = _this$state.assignment;\n      e.preventDefault();\n      this.setState({\n        validate: true\n      });\n      setTimeout(async () => {\n        this.setState({\n          validate: false\n        });\n        const errors = document.querySelectorAll(\".text__input__error\");\n\n        if (errors.length === 0) {\n          this.setState({\n            loading: true\n          });\n\n          if (is_edit) {\n            await this.props.edit(assignment);\n            this.close();\n          } else {\n            await this.props.create(assignment);\n            this.close();\n          }\n        }\n      }, 50);\n    };\n\n    this.close = () => {\n      this.setState({\n        loaded: false\n      });\n      setTimeout(() => {\n        this.props.toggleHandleAssignment();\n      }, 400);\n    };\n\n    this.setAssignment = assignment => {\n      this.setState({\n        assignment_updated: true,\n        assignment: {\n          title: assignment.title,\n          text: assignment.text,\n          files: assignment.files\n        }\n      });\n      setTimeout(() => {\n        this.setState({\n          assignment_updated: false\n        });\n      }, 50);\n    };\n\n    this.scrolltop = () => {\n      this.componentRef.current.scrollTop = 0;\n    };\n\n    this.state = {\n      assignment: {}\n    };\n    this.componentRef = React.createRef();\n  }\n\n  componentDidMount() {\n    const _this$props = this.props,\n          assignment_to_edit = _this$props.assignment_to_edit,\n          new_assignment = _this$props.new_assignment;\n    this.setState({\n      is_edit: assignment_to_edit,\n      assignment: assignment_to_edit ? assignment_to_edit : {}\n    });\n\n    if (new_assignment) {\n      this.setState({\n        assignment: new_assignment\n      });\n    }\n\n    setTimeout(() => {\n      this.setState({\n        loaded: true\n      });\n    }, 20);\n  }\n\n  render() {\n    const _this$state2 = this.state,\n          loaded = _this$state2.loaded,\n          is_edit = _this$state2.is_edit,\n          validate = _this$state2.validate,\n          assignment = _this$state2.assignment,\n          show_options = _this$state2.show_options,\n          assignment_updated = _this$state2.assignment_updated,\n          loading = _this$state2.loading;\n    const _this$props2 = this.props,\n          from_employee_page = _this$props2.from_employee_page,\n          assignments_list = _this$props2.assignments_list;\n    const system_text = this.props.global.system_text;\n    return React.createElement(\"div\", {\n      id: loaded ? \"assignments__handle--active\" : \"\",\n      className: \"assignments__handle\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 110\n      },\n      __self: this\n    }, React.createElement(\"section\", {\n      className: \"overlay\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 114\n      },\n      __self: this\n    }), React.createElement(\"form\", {\n      ref: this.componentRef,\n      onSubmit: e => this.submitForm(e),\n      className: \"assignments__handle__form\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 115\n      },\n      __self: this\n    }, from_employee_page && show_options ? React.createElement(EmployeeAssignmentsPopup, {\n      closePopup: () => this.setState({\n        show_options: false\n      }),\n      assignments_list: assignments_list,\n      setAssignment: this.setAssignment,\n      system_text: system_text,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 123\n      },\n      __self: this\n    }) : '', React.createElement(\"button\", {\n      style: {\n        opacity: loaded ? 1 : 0\n      },\n      type: \"button\",\n      onClick: () => this.close(),\n      className: \"assignments__handle__form__close flex__center\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 130\n      },\n      __self: this\n    }, React.createElement(CloseIcon, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 139\n      },\n      __self: this\n    })), React.createElement(\"h2\", {\n      className: \"section__h2\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 141\n      },\n      __self: this\n    }, is_edit ? system_text.EDIT : system_text.CREATE), from_employee_page && !is_edit ? React.createElement(\"button\", {\n      type: \"button\",\n      onClick: () => this.setState({\n        show_options: true\n      }),\n      className: \"save__btn suggestions__btn\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 143\n      },\n      __self: this\n    }, system_text.TEMPLATES) : '', from_employee_page ? React.createElement(MaterialDatepicker, {\n      sendDate: this.updateStateAssignment,\n      property_name: \"deadline\",\n      date: assignment ? assignment.deadline : \"\",\n      title: system_text.DEADLINE,\n      empty_error: \"Required field\",\n      validate: validate,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 151\n      },\n      __self: this\n    }) : '', assignment && loaded && assignments_inputs_data.map(input => {\n      switch (input.type) {\n        case \"draft\":\n          return React.createElement(DraftInput, {\n            handleUpdate: this.updateStateAssignment,\n            input: input,\n            validate: validate,\n            property_name: input.property_name,\n            value: assignment ? assignment.text : '',\n            label: input.label,\n            system_text: system_text,\n            updated: assignment_updated,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 166\n            },\n            __self: this\n          });\n\n        default:\n          return React.createElement(TextInput, {\n            handleUpdate: this.updateStateAssignment,\n            input: input,\n            validate: validate,\n            property_name: input.property_name,\n            value: assignment ? assignment[input.property_name] : \"\",\n            system_text: system_text,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 179\n            },\n            __self: this\n          });\n      }\n    }), from_employee_page ? React.createElement(\"div\", {\n      className: \"assignments__handle__employee__page\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 191\n      },\n      __self: this\n    }, is_edit ? React.createElement(\"section\", {\n      id: \"assignments__handle__employee__status\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 193\n      },\n      __self: this\n    }, React.createElement(\"h3\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 194\n      },\n      __self: this\n    }, system_text.STATUS), React.createElement(\"aside\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 195\n      },\n      __self: this\n    }, system_text.ASSIGNMENT_STATUS_ARR.map(m => {\n      return React.createElement(\"button\", {\n        type: \"button\",\n        className: assignment.status === m.value ? \"save__btn\" : \"cancel__btn\",\n        onClick: () => this.updateStateAssignment(\"status\", m.value),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 198\n        },\n        __self: this\n      }, m.text);\n    }))) : \"\") : \"\", React.createElement(FilesUpload, {\n      update: this.updateStateAssignment,\n      property_name: \"files\",\n      files: assignment ? assignment.files : [],\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 222\n      },\n      __self: this\n    }), React.createElement(SubmitButtons, {\n      close: this.close,\n      submit_text: system_text.SAVE,\n      close_text: system_text.CANCEL,\n      loading: loading,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 227\n      },\n      __self: this\n    })));\n  }\n\n}\n\nfunction mapStateToProps({\n  assignments,\n  global\n}) {\n  return {\n    assignments,\n    global\n  };\n}\n\nexport default connect(mapStateToProps, actions)(HandleAssignment);","map":{"version":3,"sources":["/Users/denis/Desktop/projects/todo/front/client/src/components/assignments/parts/HandleAssignment.jsx"],"names":["React","Component","assignments_inputs_data","TextInput","connect","actions","DraftInput","CloseIcon","FilesUpload","SubmitButtons","EmployeeAssignmentsPopup","MaterialDatepicker","HandleAssignment","constructor","updateStateAssignment","name","value","assignment","state","new_assignment","JSON","parse","stringify","setState","submitForm","e","is_edit","preventDefault","validate","setTimeout","errors","document","querySelectorAll","length","loading","props","edit","close","create","loaded","toggleHandleAssignment","setAssignment","assignment_updated","title","text","files","scrolltop","componentRef","current","scrollTop","createRef","componentDidMount","assignment_to_edit","render","show_options","from_employee_page","assignments_list","system_text","global","opacity","EDIT","CREATE","TEMPLATES","deadline","DEADLINE","map","input","type","property_name","label","STATUS","ASSIGNMENT_STATUS_ARR","m","status","SAVE","CANCEL","mapStateToProps","assignments"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,OAAOC,uBAAP,MAAoC,2BAApC;AACA,OAAOC,SAAP,MAAsB,iCAAtB;AACA,SAASC,OAAT,QAAwB,aAAxB;AACA,OAAO,KAAKC,OAAZ,MAAyB,0BAAzB;AACA,OAAOC,UAAP,MAAuB,kCAAvB;AACA,OAAOC,SAAP,MAAsB,0BAAtB;AACA,OAAOC,WAAP,MAAwB,4BAAxB;AACA,OAAOC,aAAP,MAA0B,8BAA1B;AACA,OAAOC,wBAAP,MAAqC,mEAArC;AACA,OAAOC,kBAAP,MAA+B,mCAA/B;;AAEA,MAAMC,gBAAN,SAA+BX,SAA/B,CAAyC;AACvCY,EAAAA,WAAW,GAAG;AACZ;;AADY,SA0BdC,qBA1Bc,GA0BU,CAACC,IAAD,EAAOC,KAAP,KAAiB;AAAA,YAC/BC,UAD+B,GAChB,KAAKC,KADW,CAC/BD,UAD+B;AAEvC,UAAIE,cAAc,GAAGC,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,SAAL,CAAeL,UAAf,CAAX,CAArB;AACAE,MAAAA,cAAc,CAACJ,IAAD,CAAd,GAAuBC,KAAvB;AACA,WAAKO,QAAL,CAAc;AACZN,QAAAA,UAAU,EAAEE;AADA,OAAd;AAGD,KAjCa;;AAAA,SAmCdK,UAnCc,GAmCD,MAAOC,CAAP,IAAa;AAAA,0BACQ,KAAKP,KADb;AAAA,YAChBQ,OADgB,eAChBA,OADgB;AAAA,YACPT,UADO,eACPA,UADO;AAExBQ,MAAAA,CAAC,CAACE,cAAF;AACA,WAAKJ,QAAL,CAAc;AACZK,QAAAA,QAAQ,EAAE;AADE,OAAd;AAGAC,MAAAA,UAAU,CAAC,YAAY;AACrB,aAAKN,QAAL,CAAc;AACZK,UAAAA,QAAQ,EAAE;AADE,SAAd;AAGA,cAAME,MAAM,GAAGC,QAAQ,CAACC,gBAAT,CAA0B,qBAA1B,CAAf;;AACA,YAAIF,MAAM,CAACG,MAAP,KAAkB,CAAtB,EAAyB;AACvB,eAAKV,QAAL,CAAc;AACZW,YAAAA,OAAO,EAAC;AADI,WAAd;;AAGA,cAAIR,OAAJ,EAAa;AACX,kBAAM,KAAKS,KAAL,CAAWC,IAAX,CAAgBnB,UAAhB,CAAN;AACA,iBAAKoB,KAAL;AACD,WAHD,MAGO;AACL,kBAAM,KAAKF,KAAL,CAAWG,MAAX,CAAkBrB,UAAlB,CAAN;AACA,iBAAKoB,KAAL;AACD;AACF;AACF,OAjBS,EAiBP,EAjBO,CAAV;AAkBD,KA3Da;;AAAA,SA6DdA,KA7Dc,GA6DN,MAAM;AACZ,WAAKd,QAAL,CAAc;AACZgB,QAAAA,MAAM,EAAE;AADI,OAAd;AAGAV,MAAAA,UAAU,CAAC,MAAM;AACf,aAAKM,KAAL,CAAWK,sBAAX;AACD,OAFS,EAEP,GAFO,CAAV;AAGD,KApEa;;AAAA,SAqEdC,aArEc,GAqEGxB,UAAD,IAAgB;AAC9B,WAAKM,QAAL,CAAc;AACZmB,QAAAA,kBAAkB,EAAC,IADP;AAEZzB,QAAAA,UAAU,EAAC;AACT0B,UAAAA,KAAK,EAAC1B,UAAU,CAAC0B,KADR;AAETC,UAAAA,IAAI,EAAC3B,UAAU,CAAC2B,IAFP;AAGTC,UAAAA,KAAK,EAAC5B,UAAU,CAAC4B;AAHR;AAFC,OAAd;AAQAhB,MAAAA,UAAU,CAAC,MAAM;AACf,aAAKN,QAAL,CAAc;AACZmB,UAAAA,kBAAkB,EAAC;AADP,SAAd;AAGD,OAJS,EAIP,EAJO,CAAV;AAKD,KAnFa;;AAAA,SAoFdI,SApFc,GAoFF,MAAM;AAEhB,WAAKC,YAAL,CAAkBC,OAAlB,CAA0BC,SAA1B,GAAsC,CAAtC;AAGD,KAzFa;;AAEZ,SAAK/B,KAAL,GAAa;AACXD,MAAAA,UAAU,EAAE;AADD,KAAb;AAGA,SAAK8B,YAAL,GAAoB/C,KAAK,CAACkD,SAAN,EAApB;AACD;;AAEDC,EAAAA,iBAAiB,GAAG;AAAA,wBAC6B,KAAKhB,KADlC;AAAA,UACViB,kBADU,eACVA,kBADU;AAAA,UACUjC,cADV,eACUA,cADV;AAElB,SAAKI,QAAL,CAAc;AACZG,MAAAA,OAAO,EAAE0B,kBADG;AAEZnC,MAAAA,UAAU,EAAEmC,kBAAkB,GAAGA,kBAAH,GAAwB;AAF1C,KAAd;;AAIA,QAAIjC,cAAJ,EAAoB;AAClB,WAAKI,QAAL,CAAc;AACZN,QAAAA,UAAU,EAAEE;AADA,OAAd;AAGD;;AACDU,IAAAA,UAAU,CAAC,MAAM;AACf,WAAKN,QAAL,CAAc;AACZgB,QAAAA,MAAM,EAAE;AADI,OAAd;AAGD,KAJS,EAIP,EAJO,CAAV;AAKD;;AAmEDc,EAAAA,MAAM,GAAG;AAAA,yBACsF,KAAKnC,KAD3F;AAAA,UACCqB,MADD,gBACCA,MADD;AAAA,UACSb,OADT,gBACSA,OADT;AAAA,UACkBE,QADlB,gBACkBA,QADlB;AAAA,UAC4BX,UAD5B,gBAC4BA,UAD5B;AAAA,UACwCqC,YADxC,gBACwCA,YADxC;AAAA,UACuDZ,kBADvD,gBACuDA,kBADvD;AAAA,UAC2ER,OAD3E,gBAC2EA,OAD3E;AAAA,yBAE0C,KAAKC,KAF/C;AAAA,UAECoB,kBAFD,gBAECA,kBAFD;AAAA,UAEqBC,gBAFrB,gBAEqBA,gBAFrB;AAAA,UAGAC,WAHA,GAGe,KAAKtB,KAAL,CAAWuB,MAH1B,CAGAD,WAHA;AAIP,WACE;AACE,MAAA,EAAE,EAAElB,MAAM,GAAG,6BAAH,GAAmC,EAD/C;AAEE,MAAA,SAAS,EAAC,qBAFZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAIE;AAAS,MAAA,SAAS,EAAC,SAAnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAJF,EAKE;AACM,MAAA,GAAG,EAAG,KAAKQ,YADjB;AAGE,MAAA,QAAQ,EAAGtB,CAAD,IAAO,KAAKD,UAAL,CAAgBC,CAAhB,CAHnB;AAIE,MAAA,SAAS,EAAC,2BAJZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAOI8B,kBAAkB,IAAID,YAAtB,GACA,oBAAC,wBAAD;AACA,MAAA,UAAU,EAAI,MAAM,KAAK/B,QAAL,CAAc;AAAC+B,QAAAA,YAAY,EAAC;AAAd,OAAd,CADpB;AAEA,MAAA,gBAAgB,EAAIE,gBAFpB;AAGA,MAAA,aAAa,EAAG,KAAKf,aAHrB;AAIA,MAAA,WAAW,EAAIgB,WAJf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADA,GAMK,EAbT,EAeE;AACE,MAAA,KAAK,EAAE;AACLE,QAAAA,OAAO,EAAEpB,MAAM,GAAG,CAAH,GAAO;AADjB,OADT;AAIE,MAAA,IAAI,EAAC,QAJP;AAKE,MAAA,OAAO,EAAE,MAAM,KAAKF,KAAL,EALjB;AAME,MAAA,SAAS,EAAC,+CANZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OASE,oBAAC,SAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MATF,CAfF,EA0BE;AAAI,MAAA,SAAS,EAAC,aAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAA6BX,OAAO,GAAG+B,WAAW,CAACG,IAAf,GAAqBH,WAAW,CAACI,MAArE,CA1BF,EA2BGN,kBAAkB,IAAI,CAAC7B,OAAvB,GACC;AACA,MAAA,IAAI,EAAC,QADL;AAEA,MAAA,OAAO,EAAI,MAAM,KAAKH,QAAL,CAAc;AAAC+B,QAAAA,YAAY,EAAC;AAAd,OAAd,CAFjB;AAGF,MAAA,SAAS,EAAC,4BAHR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAGsCG,WAAW,CAACK,SAHlD,CADD,GAMD,EAjCF,EAmCEP,kBAAkB,GAClB,oBAAC,kBAAD;AACE,MAAA,QAAQ,EAAE,KAAKzC,qBADjB;AAEE,MAAA,aAAa,EAAC,UAFhB;AAGE,MAAA,IAAI,EAAEG,UAAU,GAAGA,UAAU,CAAC8C,QAAd,GAAyB,EAH3C;AAIE,MAAA,KAAK,EAAEN,WAAW,CAACO,QAJrB;AAKE,MAAA,WAAW,EAAC,gBALd;AAME,MAAA,QAAQ,EAAEpC,QANZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADkB,GASb,EA5CP,EA8CGX,UAAU,IAAIsB,MAAd,IACCrC,uBAAuB,CAAC+D,GAAxB,CAA6BC,KAAD,IAAW;AACrC,cAAQA,KAAK,CAACC,IAAd;AACE,aAAK,OAAL;AACE,iBACE,oBAAC,UAAD;AACE,YAAA,YAAY,EAAE,KAAKrD,qBADrB;AAEE,YAAA,KAAK,EAAEoD,KAFT;AAGE,YAAA,QAAQ,EAAEtC,QAHZ;AAIE,YAAA,aAAa,EAAEsC,KAAK,CAACE,aAJvB;AAKE,YAAA,KAAK,EAAEnD,UAAU,GAAGA,UAAU,CAAC2B,IAAd,GAAqB,EALxC;AAME,YAAA,KAAK,EAAEsB,KAAK,CAACG,KANf;AAOE,YAAA,WAAW,EAAIZ,WAPjB;AAQE,YAAA,OAAO,EAAIf,kBARb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YADF;;AAYF;AACE,iBACE,oBAAC,SAAD;AACE,YAAA,YAAY,EAAE,KAAK5B,qBADrB;AAEE,YAAA,KAAK,EAAEoD,KAFT;AAGE,YAAA,QAAQ,EAAEtC,QAHZ;AAIE,YAAA,aAAa,EAAEsC,KAAK,CAACE,aAJvB;AAKE,YAAA,KAAK,EAAEnD,UAAU,GAAGA,UAAU,CAACiD,KAAK,CAACE,aAAP,CAAb,GAAqC,EALxD;AAME,YAAA,WAAW,EAAIX,WANjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YADF;AAfJ;AA0BD,KA3BD,CA/CJ,EA2EGF,kBAAkB,GACjB;AAAK,MAAA,SAAS,EAAC,qCAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACG7B,OAAO,GACN;AAAS,MAAA,EAAE,EAAC,uCAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAK+B,WAAW,CAACa,MAAjB,CADF,EAEE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACGb,WAAW,CAACc,qBAAZ,CAAkCN,GAAlC,CAAuCO,CAAD,IAAO;AAC5C,aACE;AACE,QAAA,IAAI,EAAC,QADP;AAEE,QAAA,SAAS,EACPvD,UAAU,CAACwD,MAAX,KAAsBD,CAAC,CAACxD,KAAxB,GACI,WADJ,GAEI,aALR;AAOE,QAAA,OAAO,EAAE,MACP,KAAKF,qBAAL,CAA2B,QAA3B,EAAqC0D,CAAC,CAACxD,KAAvC,CARJ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAWGwD,CAAC,CAAC5B,IAXL,CADF;AAeD,KAhBA,CADH,CAFF,CADM,GAwBN,EAzBJ,CADiB,GA8BjB,EAzGJ,EA2GE,oBAAC,WAAD;AACE,MAAA,MAAM,EAAE,KAAK9B,qBADf;AAEE,MAAA,aAAa,EAAC,OAFhB;AAGE,MAAA,KAAK,EAAEG,UAAU,GAAGA,UAAU,CAAC4B,KAAd,GAAsB,EAHzC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MA3GF,EAgHE,oBAAC,aAAD;AACE,MAAA,KAAK,EAAE,KAAKR,KADd;AAEE,MAAA,WAAW,EAAEoB,WAAW,CAACiB,IAF3B;AAGE,MAAA,UAAU,EAAEjB,WAAW,CAACkB,MAH1B;AAIE,MAAA,OAAO,EAAEzC,OAJX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAhHF,CALF,CADF;AA+HD;;AA/NsC;;AAkOzC,SAAS0C,eAAT,CAAyB;AAAEC,EAAAA,WAAF;AAAenB,EAAAA;AAAf,CAAzB,EAAkD;AAChD,SAAO;AAAEmB,IAAAA,WAAF;AAAenB,IAAAA;AAAf,GAAP;AACD;;AAED,eAAetD,OAAO,CAACwE,eAAD,EAAkBvE,OAAlB,CAAP,CAAkCO,gBAAlC,CAAf","sourcesContent":["import React, { Component } from \"react\";\nimport assignments_inputs_data from \"./assignments_inputs_data\";\nimport TextInput from \"../../../parts/inputs/TextInput\";\nimport { connect } from \"react-redux\";\nimport * as actions from \"../../../actions/actions\";\nimport DraftInput from \"../../../parts/inputs/DraftInput\";\nimport CloseIcon from \"@material-ui/icons/Close\";\nimport FilesUpload from \"../../../parts/FilesUpload\";\nimport SubmitButtons from \"../../../parts/SubmitButtons\";\nimport EmployeeAssignmentsPopup from \"../../employee-page/employee-assignments/EmployeeAssignmentsPopup\";\nimport MaterialDatepicker from \"../../../parts/MaterialDatepicker\";\n\nclass HandleAssignment extends Component {\n  constructor() {\n    super();\n    this.state = {\n      assignment: {},\n    };\n    this.componentRef = React.createRef();\n  }\n\n  componentDidMount() {\n    const { assignment_to_edit, new_assignment } = this.props;\n    this.setState({\n      is_edit: assignment_to_edit,\n      assignment: assignment_to_edit ? assignment_to_edit : {},\n    });\n    if (new_assignment) {\n      this.setState({\n        assignment: new_assignment,\n      });\n    }\n    setTimeout(() => {\n      this.setState({\n        loaded: true,\n      });\n    }, 20);\n  }\n\n  updateStateAssignment = (name, value) => {\n    const { assignment } = this.state;\n    let new_assignment = JSON.parse(JSON.stringify(assignment));\n    new_assignment[name] = value;\n    this.setState({\n      assignment: new_assignment,\n    });\n  };\n\n  submitForm = async (e) => {\n    const { is_edit, assignment } = this.state;\n    e.preventDefault();\n    this.setState({\n      validate: true,\n    });\n    setTimeout(async () => {\n      this.setState({\n        validate: false,\n      });\n      const errors = document.querySelectorAll(\".text__input__error\");\n      if (errors.length === 0) {\n        this.setState({\n          loading:true\n        })\n        if (is_edit) {\n          await this.props.edit(assignment);\n          this.close();\n        } else {\n          await this.props.create(assignment);\n          this.close();\n        }\n      }\n    }, 50);\n  };\n\n  close = () => {\n    this.setState({\n      loaded: false,\n    });\n    setTimeout(() => {\n      this.props.toggleHandleAssignment();\n    }, 400);\n  };\n  setAssignment = (assignment) => {\n    this.setState({\n      assignment_updated:true,\n      assignment:{\n        title:assignment.title,\n        text:assignment.text,\n        files:assignment.files\n      }\n    })\n    setTimeout(() => {\n      this.setState({\n        assignment_updated:false,\n      })\n    }, 50);\n  }\n  scrolltop = () => {\n  \n    this.componentRef.current.scrollTop = 0;\n\n\n  }\n\n  render() {\n    const { loaded, is_edit, validate, assignment, show_options , assignment_updated, loading} = this.state;\n    const { from_employee_page, assignments_list } = this.props;\n    const {system_text} = this.props.global\n    return (\n      <div\n        id={loaded ? \"assignments__handle--active\" : \"\"}\n        className=\"assignments__handle\"\n      >\n        <section className=\"overlay\"></section>\n        <form\n              ref={ this.componentRef }\n\n          onSubmit={(e) => this.submitForm(e)}\n          className=\"assignments__handle__form\"\n        >\n          {\n            from_employee_page && show_options? \n            <EmployeeAssignmentsPopup \n            closePopup = {() => this.setState({show_options:false})}\n            assignments_list = {assignments_list}\n            setAssignment ={this.setAssignment}\n            system_text = {system_text}\n            />  :''\n          }\n          <button\n            style={{\n              opacity: loaded ? 1 : 0,\n            }}\n            type=\"button\"\n            onClick={() => this.close()}\n            className=\"assignments__handle__form__close flex__center\"\n          >\n            \n            <CloseIcon />\n          </button>\n          <h2 className='section__h2'>{is_edit ? system_text.EDIT :system_text.CREATE}</h2>\n          {from_employee_page && !is_edit? \n            <button \n            type='button'\n            onClick = {() => this.setState({show_options:true})}\n          className='save__btn suggestions__btn'>{system_text.TEMPLATES}</button>\n             \n        : ''}\n        {\n          from_employee_page ?\n          <MaterialDatepicker\n            sendDate={this.updateStateAssignment}\n            property_name=\"deadline\"\n            date={assignment ? assignment.deadline : \"\"}\n            title={system_text.DEADLINE}\n            empty_error=\"Required field\"\n            validate={validate}\n            \n          />  :''\n        }\n          {assignment && loaded &&\n            assignments_inputs_data.map((input) => {\n              switch (input.type) {\n                case \"draft\":\n                  return (\n                    <DraftInput\n                      handleUpdate={this.updateStateAssignment}\n                      input={input}\n                      validate={validate}\n                      property_name={input.property_name}\n                      value={assignment ? assignment.text : ''}\n                      label={input.label}\n                      system_text = {system_text}\n                      updated = {assignment_updated}\n                    />\n                  );\n                default:\n                  return (\n                    <TextInput\n                      handleUpdate={this.updateStateAssignment}\n                      input={input}\n                      validate={validate}\n                      property_name={input.property_name}\n                      value={assignment ? assignment[input.property_name] : \"\"}\n                      system_text = {system_text}\n                    />\n                  );\n              }\n            })}\n          {from_employee_page ? (\n            <div className=\"assignments__handle__employee__page\">\n              {is_edit ? (\n                <section id=\"assignments__handle__employee__status\">\n                  <h3>{system_text.STATUS}</h3>\n                  <aside>\n                    {system_text.ASSIGNMENT_STATUS_ARR.map((m) => {\n                      return (\n                        <button\n                          type=\"button\"\n                          className={\n                            assignment.status === m.value\n                              ? \"save__btn\"\n                              : \"cancel__btn\"\n                          }\n                          onClick={() =>\n                            this.updateStateAssignment(\"status\", m.value)\n                          }\n                        >\n                          {m.text}\n                        </button>\n                      );\n                    })}\n                  </aside>\n                </section>\n              ) : (\n                \"\"\n              )}\n            </div>\n          ) : (\n            \"\"\n          )}\n          <FilesUpload\n            update={this.updateStateAssignment}\n            property_name=\"files\"\n            files={assignment ? assignment.files : []}\n          />\n          <SubmitButtons\n            close={this.close}\n            submit_text={system_text.SAVE}\n            close_text={system_text.CANCEL}\n            loading={loading}\n          />\n        </form>\n      </div>\n    );\n  }\n}\n\nfunction mapStateToProps({ assignments, global }) {\n  return { assignments, global };\n}\n\nexport default connect(mapStateToProps, actions)(HandleAssignment);\n"]},"metadata":{},"sourceType":"module"}