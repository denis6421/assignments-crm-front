{"ast":null,"code":"import _regeneratorRuntime from\"/Users/denis/Desktop/projects/todo/front/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/denis/Desktop/projects/todo/front/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _defineProperty from\"/Users/denis/Desktop/projects/todo/front/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _classCallCheck from\"/Users/denis/Desktop/projects/todo/front/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/denis/Desktop/projects/todo/front/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/Users/denis/Desktop/projects/todo/front/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/Users/denis/Desktop/projects/todo/front/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/Users/denis/Desktop/projects/todo/front/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;});keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach(function(key){_defineProperty(target,key,source[key]);});}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source));}else{ownKeys(source).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}}return target;}import React,{Component}from\"react\";import signin_inputs from\"./signin-inputs\";import TextInput from\"../../../parts/inputs/TextInput\";import{apiPostRequest}from\"../../../tools/api\";import{connect}from\"react-redux\";import*as actions from\"../../../actions/actions\";import{DASHBOARD_ROUTE,EMPLOYEES_ROUTE,EMPLOYEE_DASHBOARD_ROUTE,EMPLOYEE_DASHBOARD_PAGE_ROUTE}from\"../../../tools/routes\";import{setCookie,removeCookie}from\"../../../tools/cookie\";import{AUTH_TOKEN}from\"../../../tools/keys\";import{withRouter}from\"react-router\";import SumbitBtn from\"../../../parts/SumbitBtn\";import AccountCircleRoundedIcon from'@material-ui/icons/AccountCircleRounded';var SignInForm=/*#__PURE__*/function(_Component){_inherits(SignInForm,_Component);function SignInForm(){var _this;_classCallCheck(this,SignInForm);_this=_possibleConstructorReturn(this,_getPrototypeOf(SignInForm).call(this));_this.updateForm=function(name,value){var form_data=_objectSpread({},_this.state.form_data);form_data[name]=value;_this.setState({form_data:form_data});};_this.submitForm=function(e){e.preventDefault();_this.setState({validate:true});setTimeout(function(){var errors=document.querySelectorAll(\".text__input__error\");if(errors.length===0){_this.signin();}_this.setState({validate:false});},50);};_this.signin=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var form_data,api,res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:form_data=_this.state.form_data;_this.setState({loading:true});api=\"auth/login\";_context.next=5;return apiPostRequest(api,form_data);case 5:res=_context.sent;if(!res.ok){_context.next=18;break;}_this.props.updateUserReducer(\"user\",res.result);setCookie(AUTH_TOKEN,res.result.token);if(!res.result.is_manager){_context.next=11;break;}return _context.abrupt(\"return\",_this.props.history.push(EMPLOYEES_ROUTE));case 11:if(res.result.active){_context.next=17;break;}removeCookie(AUTH_TOKEN);_this.setState({loading:false});return _context.abrupt(\"return\",_this.props.updateGlobalReducer('error','Employee is inactive'));case 17:return _context.abrupt(\"return\",_this.props.history.push(EMPLOYEE_DASHBOARD_PAGE_ROUTE.replace(\":id\",res.result._id)));case 18:if(!res.ok&&res.result){_this.props.updateGlobalReducer('error',res.result);}_this.setState({loading:false});case 20:case\"end\":return _context.stop();}}},_callee);}));_this.state={form_data:{}};return _this;}_createClass(SignInForm,[{key:\"componentDidMount\",value:function componentDidMount(){var url=window.location.pathname.split('/');var demo=url[url.length-1];this.setState({demo:demo==='demo'});}},{key:\"render\",value:function render(){var _this2=this;var _this$state=this.state,form_data=_this$state.form_data,validate=_this$state.validate,loading=_this$state.loading,demo=_this$state.demo;return React.createElement(\"div\",{className:\"login flex__center\"},React.createElement(\"form\",{onSubmit:function onSubmit(e){return _this2.submitForm(e);},className:\"login__form signin__form flex__column\"},React.createElement(AccountCircleRoundedIcon,{style:{fontSize:'70px',marginLeft:'auto',marginRight:'auto',marginBottom:'20px',color:'rgba(0, 145, 255, 1)'}}),React.createElement(\"section\",{className:\"login__form__inputs\"},signin_inputs.map(function(input,i){return React.createElement(TextInput,{key:i,handleUpdate:_this2.updateForm,input:input,validate:validate,value:form_data[input.property_name]});}),demo?React.createElement(\"div\",{className:\"login__demo__account\"},React.createElement(\"h3\",null,\"Demo account\"),React.createElement(\"span\",{className:\"flex__start\"},React.createElement(\"h5\",null,\"Username:\"),React.createElement(\"h4\",null,\"demo@demo.com\")),React.createElement(\"span\",{className:\"flex__start\"},React.createElement(\"h5\",null,\"Password:\"),React.createElement(\"h4\",null,\"demo123\"))):''),React.createElement(SumbitBtn,{text:\"Submit\",active:loading})));}}]);return SignInForm;}(Component);function mapStateToProps(_ref2){var user=_ref2.user;return{user:user};}export default withRouter(connect(mapStateToProps,actions)(SignInForm));","map":{"version":3,"sources":["/Users/denis/Desktop/projects/todo/front/client/src/components/login/parts/SignInForm.jsx"],"names":["React","Component","signin_inputs","TextInput","apiPostRequest","connect","actions","DASHBOARD_ROUTE","EMPLOYEES_ROUTE","EMPLOYEE_DASHBOARD_ROUTE","EMPLOYEE_DASHBOARD_PAGE_ROUTE","setCookie","removeCookie","AUTH_TOKEN","withRouter","SumbitBtn","AccountCircleRoundedIcon","SignInForm","updateForm","name","value","form_data","state","setState","submitForm","e","preventDefault","validate","setTimeout","errors","document","querySelectorAll","length","signin","loading","api","res","ok","props","updateUserReducer","result","token","is_manager","history","push","active","updateGlobalReducer","replace","_id","url","window","location","pathname","split","demo","fontSize","marginLeft","marginRight","marginBottom","color","map","input","i","property_name","mapStateToProps","user"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport signin_inputs from \"./signin-inputs\";\nimport TextInput from \"../../../parts/inputs/TextInput\";\nimport { apiPostRequest } from \"../../../tools/api\";\nimport { connect } from \"react-redux\";\nimport * as actions from \"../../../actions/actions\";\nimport { DASHBOARD_ROUTE, EMPLOYEES_ROUTE, EMPLOYEE_DASHBOARD_ROUTE, EMPLOYEE_DASHBOARD_PAGE_ROUTE } from \"../../../tools/routes\";\nimport { setCookie, removeCookie } from \"../../../tools/cookie\";\nimport { AUTH_TOKEN } from \"../../../tools/keys\";\nimport { withRouter } from \"react-router\";\nimport SumbitBtn from \"../../../parts/SumbitBtn\";\nimport AccountCircleRoundedIcon from '@material-ui/icons/AccountCircleRounded';\nclass SignInForm extends Component {\n  constructor() {\n    super();\n    this.state = {\n      form_data: {},\n    };\n  }\n  componentDidMount(){\n    const url = window.location.pathname.split('/')\n    let demo = url[url.length - 1]\n    this.setState({\n      demo:demo === 'demo'\n    })\n  }\n  updateForm = (name, value) => {\n    const form_data = { ...this.state.form_data };\n    form_data[name] = value;\n    this.setState({\n      form_data,\n    });\n  };\n  submitForm = (e) => {\n    e.preventDefault();\n    this.setState({\n      validate: true,\n    });\n    setTimeout(() => {\n      const errors = document.querySelectorAll(\".text__input__error\");\n      if (errors.length === 0) {\n        this.signin();\n      } \n      this.setState({\n        validate: false,\n      });\n    }, 50);\n  };\n\n  signin = async () => {\n    const { form_data } = this.state;\n    this.setState({\n      loading:true\n    })\n    const api = \"auth/login\";\n    const res = await apiPostRequest(api, form_data);\n    if (res.ok) {\n      this.props.updateUserReducer(\"user\", res.result);\n      setCookie(AUTH_TOKEN, res.result.token);\n      if(res.result.is_manager)  return this.props.history.push(EMPLOYEES_ROUTE);\n      if(!res.result.active) {\n        removeCookie(AUTH_TOKEN);\n        this.setState({\n          loading:false\n        })\n        return  this.props.updateGlobalReducer('error','Employee is inactive');\n      }\n     else return this.props.history.push(\n      EMPLOYEE_DASHBOARD_PAGE_ROUTE.replace(\":id\", res.result._id)\n    )\n    }\n    if (!res.ok && res.result) {\n      this.props.updateGlobalReducer('error',res.result);\n    }\n    this.setState({\n      loading:false\n    })\n  };\n\n  render() {\n    const { form_data, validate, loading, demo } = this.state;\n  \n    return (\n      <div className='login flex__center'>\n       <form\n        onSubmit={(e) => this.submitForm(e)}\n        className=\"login__form signin__form flex__column\"\n      >\n        {/* <h2>Login</h2> */}\n        <AccountCircleRoundedIcon \n        style ={{\n          fontSize:'70px',\n          marginLeft:'auto',\n          marginRight:'auto',\n          marginBottom:'20px',\n          color:'rgba(0, 145, 255, 1)'\n        }}\n        />\n        <section className=\"login__form__inputs\">\n          {signin_inputs.map((input, i) => {\n            return (\n              <TextInput\n                key={i}\n                handleUpdate={this.updateForm}\n                input={input}\n                validate={validate}\n                value={form_data[input.property_name]}\n              />\n            );\n          })}\n\n          {\n            demo ? \n            <div className='login__demo__account'>\n              <h3>Demo account</h3>\n              <span className='flex__start'>\n                <h5>Username:</h5>\n                <h4>demo@demo.com</h4>\n              </span>\n              <span className='flex__start'>\n              <h5>Password:</h5>\n                <h4>demo123</h4>\n              </span>\n            </div>\n            :''\n          }\n        </section>\n       <SumbitBtn\n       text = 'Submit'\n       active = {loading}\n       />\n      </form> \n      </div>\n    );\n  }\n}\n\nfunction mapStateToProps({ user }) {\n  return { user };\n}\n\nexport default withRouter(connect(mapStateToProps, actions)(SignInForm));\n"]},"metadata":{},"sourceType":"module"}