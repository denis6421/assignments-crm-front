{"ast":null,"code":"import _defineProperty from \"/Users/denis/Desktop/projects/todo/front/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nvar _jsxFileName = \"/Users/denis/Desktop/projects/todo/front/client/src/components/login/parts/SignUpForm.jsx\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { Component } from \"react\";\nimport TextInput from \"../../../parts/inputs/TextInput\";\nimport signup_inputs from \"./signup-inputs\";\nimport { apiPostRequest } from \"../../../tools/api\";\nimport { withRouter } from \"react-router\";\nimport { connect } from \"react-redux\";\nimport * as actions from \"../../../actions/actions\";\nimport { setCookie } from \"../../../tools/cookie\";\nimport { AUTH_TOKEN } from \"../../../tools/keys\";\nimport SumbitBtn from \"../../../parts/SumbitBtn\";\nimport SignupSuccess from \"./SignupSuccess\";\nimport { EMPLOYEES_ROUTE } from \"../../../tools/routes\";\n\nclass signUpForm extends Component {\n  constructor() {\n    super();\n\n    this.updateForm = (name, value) => {\n      const form_data = _objectSpread({}, this.state.form_data);\n\n      form_data[name] = value;\n      this.setState({\n        form_data\n      });\n    };\n\n    this.submitForm = e => {\n      e.preventDefault();\n      this.setState({\n        validate: true\n      });\n      setTimeout(() => {\n        const errors = document.querySelectorAll(\".text__input__error\");\n\n        if (errors.length === 0) {\n          this.signup();\n        }\n\n        this.setState({\n          validate: false\n        });\n      }, 50);\n    };\n\n    this.signup = async () => {\n      const form_data = this.state.form_data;\n      const api = \"users/create\";\n      this.setState({\n        loading: true\n      });\n      const res = await apiPostRequest(api, form_data);\n\n      if (res.ok) {\n        this.props.updateUserReducer(\"user\", res.result);\n        setCookie(AUTH_TOKEN, res.result.token);\n        this.setState({\n          signup_success: true\n        });\n        setTimeout(() => {\n          this.props.history.push(EMPLOYEES_ROUTE);\n        }, 3000);\n      }\n\n      if (!res.ok && res.result) {\n        this.props.updateGlobalReducer('error', res.result);\n      }\n\n      this.setState({\n        loading: false\n      });\n    };\n\n    this.state = {\n      form_data: {}\n    };\n  }\n\n  render() {\n    const _this$state = this.state,\n          form_data = _this$state.form_data,\n          validate = _this$state.validate,\n          error_popup = _this$state.error_popup,\n          loading = _this$state.loading,\n          signup_success = _this$state.signup_success;\n    return React.createElement(\"div\", {\n      className: \"login flex__center\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 72\n      },\n      __self: this\n    }, React.createElement(SignupSuccess, {\n      active: signup_success,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 73\n      },\n      __self: this\n    }), React.createElement(\"form\", {\n      style: {\n        filter: signup_success ? 'blur(2px)' : ''\n      },\n      onSubmit: e => this.submitForm(e),\n      className: \"login__form signup__form flex__column\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 76\n      },\n      __self: this\n    }, React.createElement(\"h2\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 84\n      },\n      __self: this\n    }, \"Signup\"), error_popup ? React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 85\n      },\n      __self: this\n    }, error_popup) : \"\", React.createElement(\"section\", {\n      className: \"login__form__inputs\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 86\n      },\n      __self: this\n    }, signup_inputs.map((input, i) => {\n      return React.createElement(TextInput, {\n        key: i,\n        handleUpdate: this.updateForm,\n        input: input,\n        validate: validate,\n        value: form_data[input.property_name],\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 89\n        },\n        __self: this\n      });\n    })), React.createElement(SumbitBtn, {\n      text: \"Submit\",\n      active: loading,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 99\n      },\n      __self: this\n    })));\n  }\n\n}\n\nfunction mapStateToProps({\n  user\n}) {\n  return {\n    user\n  };\n}\n\nexport default withRouter(connect(mapStateToProps, actions)(signUpForm));","map":{"version":3,"sources":["/Users/denis/Desktop/projects/todo/front/client/src/components/login/parts/SignUpForm.jsx"],"names":["React","Component","TextInput","signup_inputs","apiPostRequest","withRouter","connect","actions","setCookie","AUTH_TOKEN","SumbitBtn","SignupSuccess","EMPLOYEES_ROUTE","signUpForm","constructor","updateForm","name","value","form_data","state","setState","submitForm","e","preventDefault","validate","setTimeout","errors","document","querySelectorAll","length","signup","api","loading","res","ok","props","updateUserReducer","result","token","signup_success","history","push","updateGlobalReducer","render","error_popup","filter","map","input","i","property_name","mapStateToProps","user"],"mappings":";;;;;;;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,OAAOC,SAAP,MAAsB,iCAAtB;AACA,OAAOC,aAAP,MAA0B,iBAA1B;AACA,SAASC,cAAT,QAA+B,oBAA/B;AACA,SAASC,UAAT,QAA2B,cAA3B;AACA,SAASC,OAAT,QAAwB,aAAxB;AACA,OAAO,KAAKC,OAAZ,MAAyB,0BAAzB;AACA,SAASC,SAAT,QAA0B,uBAA1B;AACA,SAASC,UAAT,QAA2B,qBAA3B;AACA,OAAOC,SAAP,MAAsB,0BAAtB;AACA,OAAOC,aAAP,MAA0B,iBAA1B;AACA,SAASC,eAAT,QAAgC,uBAAhC;;AAEA,MAAMC,UAAN,SAAyBZ,SAAzB,CAAmC;AACjCa,EAAAA,WAAW,GAAG;AACZ;;AADY,SAOdC,UAPc,GAOD,CAACC,IAAD,EAAOC,KAAP,KAAiB;AAC5B,YAAMC,SAAS,qBAAQ,KAAKC,KAAL,CAAWD,SAAnB,CAAf;;AACAA,MAAAA,SAAS,CAACF,IAAD,CAAT,GAAkBC,KAAlB;AACA,WAAKG,QAAL,CAAc;AACZF,QAAAA;AADY,OAAd;AAGD,KAba;;AAAA,SAcdG,UAdc,GAcAC,CAAD,IAAO;AAClBA,MAAAA,CAAC,CAACC,cAAF;AACA,WAAKH,QAAL,CAAc;AACZI,QAAAA,QAAQ,EAAE;AADE,OAAd;AAGAC,MAAAA,UAAU,CAAC,MAAM;AACf,cAAMC,MAAM,GAAGC,QAAQ,CAACC,gBAAT,CAA0B,qBAA1B,CAAf;;AACA,YAAIF,MAAM,CAACG,MAAP,KAAkB,CAAtB,EAAyB;AACvB,eAAKC,MAAL;AACD;;AACD,aAAKV,QAAL,CAAc;AACZI,UAAAA,QAAQ,EAAE;AADE,SAAd;AAGD,OARS,EAQP,EARO,CAAV;AASD,KA5Ba;;AAAA,SA8BdM,MA9Bc,GA8BL,YAAY;AAAA,YACXZ,SADW,GACG,KAAKC,KADR,CACXD,SADW;AAEnB,YAAMa,GAAG,GAAG,cAAZ;AACA,WAAKX,QAAL,CAAc;AACZY,QAAAA,OAAO,EAAE;AADG,OAAd;AAGA,YAAMC,GAAG,GAAG,MAAM7B,cAAc,CAAC2B,GAAD,EAAMb,SAAN,CAAhC;;AACA,UAAIe,GAAG,CAACC,EAAR,EAAY;AACV,aAAKC,KAAL,CAAWC,iBAAX,CAA6B,MAA7B,EAAqCH,GAAG,CAACI,MAAzC;AACA7B,QAAAA,SAAS,CAACC,UAAD,EAAawB,GAAG,CAACI,MAAJ,CAAWC,KAAxB,CAAT;AACA,aAAKlB,QAAL,CAAc;AACZmB,UAAAA,cAAc,EAAC;AADH,SAAd;AAGAd,QAAAA,UAAU,CAAC,MAAM;AACf,eAAKU,KAAL,CAAWK,OAAX,CAAmBC,IAAnB,CAAwB7B,eAAxB;AACD,SAFS,EAEP,IAFO,CAAV;AAGD;;AACD,UAAI,CAACqB,GAAG,CAACC,EAAL,IAAWD,GAAG,CAACI,MAAnB,EAA2B;AACzB,aAAKF,KAAL,CAAWO,mBAAX,CAA+B,OAA/B,EAAuCT,GAAG,CAACI,MAA3C;AACD;;AACD,WAAKjB,QAAL,CAAc;AACZY,QAAAA,OAAO,EAAE;AADG,OAAd;AAGD,KArDa;;AAEZ,SAAKb,KAAL,GAAa;AACXD,MAAAA,SAAS,EAAE;AADA,KAAb;AAGD;;AAiDDyB,EAAAA,MAAM,GAAG;AAAA,wBAC+D,KAAKxB,KADpE;AAAA,UACCD,SADD,eACCA,SADD;AAAA,UACYM,QADZ,eACYA,QADZ;AAAA,UACsBoB,WADtB,eACsBA,WADtB;AAAA,UACmCZ,OADnC,eACmCA,OADnC;AAAA,UAC4CO,cAD5C,eAC4CA,cAD5C;AAEP,WACE;AAAK,MAAA,SAAS,EAAC,oBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE,oBAAC,aAAD;AACA,MAAA,MAAM,EAAIA,cADV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF,EAIE;AACA,MAAA,KAAK,EAAG;AACNM,QAAAA,MAAM,EAACN,cAAc,GAAG,WAAH,GAAiB;AADhC,OADR;AAKE,MAAA,QAAQ,EAAGjB,CAAD,IAAO,KAAKD,UAAL,CAAgBC,CAAhB,CALnB;AAME,MAAA,SAAS,EAAC,uCANZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAQE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBARF,EASGsB,WAAW,GAAG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAIA,WAAJ,CAAH,GAA0B,EATxC,EAUE;AAAS,MAAA,SAAS,EAAC,qBAAnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACGzC,aAAa,CAAC2C,GAAd,CAAkB,CAACC,KAAD,EAAQC,CAAR,KAAc;AAC/B,aACE,oBAAC,SAAD;AACE,QAAA,GAAG,EAAEA,CADP;AAEE,QAAA,YAAY,EAAE,KAAKjC,UAFrB;AAGE,QAAA,KAAK,EAAEgC,KAHT;AAIE,QAAA,QAAQ,EAAEvB,QAJZ;AAKE,QAAA,KAAK,EAAEN,SAAS,CAAC6B,KAAK,CAACE,aAAP,CALlB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADF;AASD,KAVA,CADH,CAVF,EAuBE,oBAAC,SAAD;AAAW,MAAA,IAAI,EAAC,QAAhB;AAAyB,MAAA,MAAM,EAAEjB,OAAjC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAvBF,CAJF,CADF;AAgCD;;AAzFgC;;AA4FnC,SAASkB,eAAT,CAAyB;AAAEC,EAAAA;AAAF,CAAzB,EAAmC;AACjC,SAAO;AAAEA,IAAAA;AAAF,GAAP;AACD;;AAED,eAAe9C,UAAU,CAACC,OAAO,CAAC4C,eAAD,EAAkB3C,OAAlB,CAAP,CAAkCM,UAAlC,CAAD,CAAzB","sourcesContent":["import React, { Component } from \"react\";\nimport TextInput from \"../../../parts/inputs/TextInput\";\nimport signup_inputs from \"./signup-inputs\";\nimport { apiPostRequest } from \"../../../tools/api\";\nimport { withRouter } from \"react-router\";\nimport { connect } from \"react-redux\";\nimport * as actions from \"../../../actions/actions\";\nimport { setCookie } from \"../../../tools/cookie\";\nimport { AUTH_TOKEN } from \"../../../tools/keys\";\nimport SumbitBtn from \"../../../parts/SumbitBtn\";\nimport SignupSuccess from \"./SignupSuccess\";\nimport { EMPLOYEES_ROUTE } from \"../../../tools/routes\";\n\nclass signUpForm extends Component {\n  constructor() {\n    super();\n    this.state = {\n      form_data: {},\n    };\n  }\n\n  updateForm = (name, value) => {\n    const form_data = { ...this.state.form_data };\n    form_data[name] = value;\n    this.setState({\n      form_data,\n    });\n  };\n  submitForm = (e) => {\n    e.preventDefault();\n    this.setState({\n      validate: true,\n    });\n    setTimeout(() => {\n      const errors = document.querySelectorAll(\".text__input__error\");\n      if (errors.length === 0) {\n        this.signup();\n      }\n      this.setState({\n        validate: false,\n      });\n    }, 50);\n  };\n\n  signup = async () => {\n    const { form_data } = this.state;\n    const api = \"users/create\";\n    this.setState({\n      loading: true,\n    });\n    const res = await apiPostRequest(api, form_data);\n    if (res.ok) {\n      this.props.updateUserReducer(\"user\", res.result);\n      setCookie(AUTH_TOKEN, res.result.token);\n      this.setState({\n        signup_success:true\n      })\n      setTimeout(() => {\n        this.props.history.push(EMPLOYEES_ROUTE)\n      }, 3000);\n    }\n    if (!res.ok && res.result) {\n      this.props.updateGlobalReducer('error',res.result);\n    }\n    this.setState({\n      loading: false,\n    });\n  };\n  render() {\n    const { form_data, validate, error_popup, loading, signup_success } = this.state;\n    return (\n      <div className=\"login flex__center\">\n        <SignupSuccess \n        active = {signup_success}\n        />\n        <form\n        style ={{\n          filter:signup_success ? 'blur(2px)' : '',\n        \n        }}\n          onSubmit={(e) => this.submitForm(e)}\n          className=\"login__form signup__form flex__column\"\n        >\n          <h2>Signup</h2>\n          {error_popup ? <p>{error_popup}</p> : \"\"}\n          <section className=\"login__form__inputs\">\n            {signup_inputs.map((input, i) => {\n              return (\n                <TextInput\n                  key={i}\n                  handleUpdate={this.updateForm}\n                  input={input}\n                  validate={validate}\n                  value={form_data[input.property_name]}\n                />\n              );\n            })}\n          </section>\n          <SumbitBtn text=\"Submit\" active={loading} />\n        </form>\n      </div>\n    );\n  }\n}\n\nfunction mapStateToProps({ user }) {\n  return { user };\n}\n\nexport default withRouter(connect(mapStateToProps, actions)(signUpForm));\n"]},"metadata":{},"sourceType":"module"}